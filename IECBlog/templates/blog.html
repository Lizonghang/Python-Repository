<!DOCTYPE HTML><html><head>    <title>来，我给你说怎么切图</title>    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>    <meta name="description" content=""/>    <meta name="keywords" content=""/>    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:700italic,400,300,700' rel='stylesheet'          type='text/css'>    <script src="/static/admin/js/jquery.min.js"></script>    <script src="/static/admin/js/jquery.js"></script>    <link rel="stylesheet" href="/static/admin/css/exmachina/skel-noscript.css"/>    <link rel="stylesheet" href="/static/admin/css/exmachina/style.css"/>    <link rel="stylesheet" href="/static/admin/css/exmachina/style-desktop.css"/>    <link rel="stylesheet" href="/static/admin/css/screen.css"></head><body class="left-sidebar"><!-- Header --><div id="header">    <div class="container">        <!-- Logo -->        <div id="logo">            <h1><a href="javascript:void(0);">toxni'S BLOG</a></h1>        </div>        <!-- Nav -->        <nav id="nav">            <ul>                <li><a href="javascript:void(0);">Homepage</a></li>                <li class="active"><a href="javascript:void(0);">BLOG</a></li>                <li><a href="javascript:void(0);">UNDEFINED</a></li>                <li><a href="javascript:void(0);">UNDEFINED</a></li>            </ul>        </nav>    </div></div><!-- Header --><!-- Banner --><div id="banner">    <div class="container">    </div></div><!-- /Banner --><!-- Main --><div id="page">    <!-- Main -->    <div id="main" class="container">        <div class="row">            <!-- Side Block -->            <div class="3u">                <section class="sidebar">                    <header>                        <h2>近期文章</h2>                    </header>                    <ul class="style1">                        <li><a href="/blog/toxni/01/" target="_self">来，我给你说怎么切图</a></li>                        <li><a href="/blog/toxni/02/" target="_self">Linux常用指令－文件操作</a></li>                        <li><a href="/blog/toxni/03/" target="_self">Linux常用指令－用户操作</a></li>                        <li><a href="/blog/toxni/04/" target="_self">借助Bandwagon VPS科学上网</a></li>                        <li><a href="/blog/toxni/05/" target="_self">CSS_Floating *Chapter 1.1</a></li>                    </ul>                </section>                <section class="sidebar">                    <header>                        <h2>看看其它</h2>                    </header>                    <ul class="style1">                        <li><a href="javascript:void(0);">其它文章</a></li>                        <li><a href="javascript:void(0);">其它文章</a></li>                        <li><a href="javascript:void(0);">其它文章</a></li>                        <li><a href="javascript:void(0);">其它文章</a></li>                        <li><a href="javascript:void(0);">其它文章</a></li>                    </ul>                </section>            </div>            <!-- Main Article -->            <div class="9u skel-cell-important">                <section>                    <header style="text-align: center">                        <h2>来，我给你说怎么切图</h2>                        <div style="height: 20px;"></div>                        <span class="byline" id="ps">BY UESTC-IEC-TOXNI / 24 FEBRUARY 2016 on Design / <a                                href="http://www.toxni.com/" target="_blank"                                style="text-decoration: none;color: #5b80b2;">TOXNI'S BLOG</a></span>                    </header>                    <div id="article-content">                        <div>                        <code style="font-size: 14px;white-space: pre-wrap;background: transparent;border: transparent"><p style="text-indent: 2em;">每一个app在手机中运行时获得的内存是有限的，而内存占用最容易变成庞然大物的则是图片，事实上每当我们向一个view或者说imageview设置加载图片时都应当考虑我们是否对图片做了正确的处理和回收策略，最常见的便是对图片进行压缩，从而不必在小范围的显示区域内显示过大的图片，那是对内存的浪费。</p>public class SimpleImageViewUtil {    private Context context;    public SimpleImageViewUtil(Context context){        this.context = context;    }    public static Bitmap getFitSampleBitmap(Resources resources, int resId, int width, int height){ //获得合适的bitmap资源        BitmapFactory.Options options = new BitmapFactory.Options();        options.inJustDecodeBounds = true; // 仅将图像相关的参数填充到option对象中        BitmapFactory.decodeResource(resources, resId, options);//从资源文件中获得目标图片，getResources()        options.inSampleSize = getFitInSampleSize(width, height, options);//设置合适的缩放值        options.inJustDecodeBounds = false;//加载图像及相关参数        return BitmapFactory.decodeResource(resources,resId, options);//加载图片    }    public static int getFitInSampleSize(int requestWidth, int requestHeight, BitmapFactory.Options options){//获得合适的缩放值        int inSampleSize = 1;        if (options.outWidth &gt; requestWidth || options.outHeight &gt; requestHeight){//对读入的图片宽高属性和显示view的宽高进行比较，得到缩放值            int widthRatio = Math.round((float)options.outWidth / (float) requestWidth);            int heightRatio = Math.round((float)options.outHeight / (float)requestHeight);            inSampleSize = Math.min(widthRatio, heightRatio);        }        Log.i("inSample", String.valueOf(inSampleSize) + " " + options.outWidth + " " + options.outHeight + " " + requestWidth + " " + requestHeight);        return inSampleSize;    }    public int dp2pix(int dp){        float scale = context.getResources().getDisplayMetrics().density;        int pix = (int) (dp * scale + 0.5f);        return pix;    }    public int pix2dp(int pix){        float scale = context.getResources().getDisplayMetrics().density;        int dp = (int) (pix/scale + 0.5f);        return dp;    }}注意一点，request值如果是直接获取view的值则很容易会因view没有进行onMearsure而返回0解决方法如下//------------------------------------------------方法一int w = View.MeasureSpec.makeMeasureSpec(0,View.MeasureSpec.UNSPECIFIED);int h = View.MeasureSpec.makeMeasureSpec(0,View.MeasureSpec.UNSPECIFIED);imageView.measure(w, h);int height =imageView.getMeasuredHeight();int width =imageView.getMeasuredWidth();textView.append("\n"+height+","+width);//-----------------------------------------------方法二ViewTreeObserver vto = imageView.getViewTreeObserver();vto.addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() {    public boolean onPreDraw() {        int height = imageView.getMeasuredHeight();        int width = imageView.getMeasuredWidth();        textView.append("\n"+height+","+width);        return true;    }});//-----------------------------------------------方法三ViewTreeObserver vto2 = imageView.getViewTreeObserver();vto2.addOnGlobalLayoutListener(new OnGlobalLayoutListener() {    @Override    public void onGlobalLayout() {    	imageView.getViewTreeObserver().removeGlobalOnLayoutListener(this);        textView.append("\n\n"+imageView.getHeight()+","+imageView.getWidth());    }});  </code>				</div>                    </div>                </section>            </div>        </div>    </div>    <!-- Main --></div><!-- /Main --><!-- Featured --><div id="featured" style="display: block;">    <div class="container">        <div class="row">            <section class="4u">                <div class="box">                    <a href="javascript:void(0);" class="image left"><img src="/static/admin/img/exmachina/pics04.jpg"                                                                          alt=""></a>                    <h3>Etiam posuere augue</h3>                    <p>Donec nonummy magna quis risus eleifend. </p>                    <a href="javascript:void(0);" class="button">More</a>                </div>            </section>            <section class="4u">                <div class="box">                    <a href="javascript:void(0);" class="image left"><img src="/static/admin/img/exmachina/pics05.jpg"                                                                          alt=""></a>                    <h3>Etiam posuere augue</h3>                    <p>Donec nonummy magna quis risus eleifend. </p>                    <a href="javascript:void(0);" class="button">More</a>                </div>            </section>            <section class="4u">                <div class="box">                    <a href="javascript:void(0);" class="image left"><img src="/static/admin/img/exmachina/pics06.jpg"                                                                          alt=""></a>                    <h3>Etiam posuere augue</h3>                    <p>Donec nonummy magna quis risus eleifend. </p>                    <a href="javascript:void(0);" class="button">More</a>                </div>            </section>        </div>        <div class="divider"></div>    </div></div><!-- /Featured --><!-- Footer --><div id="footer" style="display: block;">    <div class="container">        <div class="row">            <div class="3u">                <section>                    <h2>toxni</h2>                    <div class="balloon">                        <blockquote>&ldquo;&nbsp;&nbsp;发发牢骚，讲讲故事，聊聊技术。&nbsp;&nbsp;&rdquo;<br><br>                            <strong>&ndash;&nbsp;&nbsp;toxni<br>&ndash;&nbsp;&nbsp;IEC前端设计师</strong></blockquote>                    </div>                    <div class="ballon-bgbtm">&nbsp;</div>                </section>            </div>            <div class="3u">                <section>                    <h2>Donec dictum</h2>                    <ul class="default">                        <li>                            <h3>Mauris vulputate dolor sit amet</h3>                            <p><a href="javascript:void(0);">Donec leo, vivamus fermentum nibh in augue praesent a lacus                                at urna congue rutrum.</a></p>                        </li>                        <li>                            <h3>Fusce ultrices fringilla metus</h3>                            <p><a href="javascript:void(0);">Donec leo, vivamus fermentum nibh in augue praesent a lacus                                at urna congue rutrum.</a></p>                        </li>                        <li>                            <h3>Donec dictum metus in sapien</h3>                            <p><a href="javascript:void(0);">Donec leo, vivamus fermentum nibh in augue praesent a lacus                                at urna congue rutrum.</a></p>                        </li>                    </ul>                </section>            </div>            <div class="3u">                <section>                    <h2>Nulla leifend</h2>                    <p>Donec placerat odio vel elit. Nullam ante orci, pellentesque eget, tempus quis, ultrices in, est.                        Curabitur sit amet nulla. Nam in massa. Sed vel tellus. Curabitur sem urna, consequat.</p>                    <ul class="style5">                        <li><a href="javascript:void(0);"><img src="/static/admin/img/exmachina/pics07.jpg"                                                               alt=""></a></li>                        <li><a href="javascript:void(0);"><img src="/static/admin/img/exmachina/pics08.jpg"                                                               alt=""></a></li>                        <li><a href="javascript:void(0);"><img src="/static/admin/img/exmachina/pics09.jpg"                                                               alt=""></a></li>                        <li><a href="javascript:void(0);"><img src="/static/admin/img/exmachina/pics10.jpg"                                                               alt=""></a></li>                        <li><a href="javascript:void(0);"><img src="/static/admin/img/exmachina/pics11.jpg"                                                               alt=""></a></li>                        <li><a href="javascript:void(0);"><img src="/static/admin/img/exmachina/pics12.jpg"                                                               alt=""></a></li>                    </ul>                    <a href="#" class="button">More Collections</a>                </section>            </div>            <div class="3u">                <section>                    <h2>Luctus eleifend</h2>                    <p><strong>Aliquam erat volutpat. Pellentesque tristique ante ut risus. </strong></p>                    <p>Quisque dictum. Integer nisl risus, sagittis convallis, rutrum id, elementum congue, nibh.                        Suspendisse dictum porta lectus. Donec placerat odio vel elit.</p>                    <p>Donec placerat odio vel elit. Nullam ante orci, pellentesque eget, tempus quis, ultrices in, est.                        Curabitur sit amet nulla. Nam in massa. Sed vel tellus. Curabitur sem urna, consequat.</p>                    <a href="javascript:void(0);" class="button">More Collections</a>                </section>            </div>        </div>    </div></div><!-- /Footer --></body></html>