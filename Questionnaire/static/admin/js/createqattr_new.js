function setListId(a,b){PDF_close(a);}var pre_satisfaction="很不满意\n不满意\n一般\n满意\n很满意";var pre_agree="很不同意\n不同意\n一般\n同意\n很同意";var pre_import="很不重要\n不重要\n一般\n重要\n很重要";var pre_accord="很不符合\n不符合\n一般\n符合\n很符合";var pre_wanting="很不愿意\n不愿意\n一般\n愿意\n很愿意";var pre_bool_1="是\n否";var pre_bool_2="对\n错";var pre_bool_3="满意\n不满意";var pre_bool_4="同意\n不同意";var pre_bool_5="正确\n错误";var pre_bool_6="支持\n反对";var pre_bool_7="Ture\nFalse";var pre_bool_8="Yes\nNo";var currentRelation="";var itemImage="";function setFloat(a){a.className="spanLeft";}function getEditorIndex(){return EditorIndex++;}function getVerifyHtml(){var b="验证：<select onchange='cur.setVerify(this);'>";var e=["0,无","数字,整数","小数","日期","手机","固话","电话,手机或固话","Email,邮件","城市单选,省份城市","省市区","高校","网址","身份证号","QQ","汉字","英文"];for(var d=0;d<e.length;d++){var f=e[d];var g=f.split(",");var a=g[0];var c=g.length==2?g[1]:g[0];b+="<option value='"+a+"'>"+c+"</option>";}b+="</select>";return b;}function checkVerifyMinMax(d,a,e){var b=d.value;var c=a.value;if(b&&!isInt(b)){return"您输入的数据不正确";}if(c&&!isInt(b)){return"您输入的数据不正确";}if(b&&c&&b-c>0){return"您输入的数据不正确";}if(e=="数字"||e=="小数"){return"";}if(b&&b-3000>0){return"字数不能超过3000";}if(c&&c-3000>0){return"字数不能超过3000";}return"";}function createAttr(){var ai=new Date().getTime();var d1;var B=document.createElement("div");this.appendChild(B);var aF=document.createDocumentFragment();this.tabAttr=B;var cz=this;var m=this.dataNode;var cw=m._type;var cV=this.dataNode._tag||0;var cG=cw=="question";var ch=cw=="slider";var u=cw=="sum";var bu=cw=="page";var F=cw=="cut";var bn=cw=="check";var aI=cw=="radio";var aW=aI&&cV;var cT=cw=="radio_down";var ar=cw=="matrix";var bZ=cw=="matrix"&&cV>300;var d2=cw=="fileupload";var dV=cw=="gapfill";var dQ=bn&&cV;var dT=aI||cT||bn||ar;var ec=!F&&!bu;var dx=m._verify||"0";var a2=dx!="0";var bE=m._isTouPiao;var bQ=m._isCeShi;var M=m._isQingJing;var cR=m._isShop;var eb=m._isCePing;var az=ar&&cV<102;var aa=this.get_div_title();var dL="";var cY=new Array();this.option_radio=cY;var aB=document.createElement("div");aB.className="div_title_attr_question";if(bQ&&!dV){this.addCeShiSetting=function(ep){var ek=$ce("div","",ep);ek.style.marginTop="15px";var en=$ce("span","<b>题目分数：</b>",ek);var em="<select onchange='cur.setTValue(this.value);'>";for(var ej=1;ej<=50;ej++){em+="<option value='"+ej+"'>"+ej+"</option>";}em+="</select>&nbsp;";en.innerHTML+=em;this.setTValue=function(i){cz.dataNode._ceshiValue=parseInt(i);dw.style.display="";if(cG){cz.spanCeShi.innerHTML="（标准答案："+cz.dataNode._answer+"，分值："+cz.dataNode._ceshiValue+"分）";}else{cz.spanCeShi.innerHTML="（分值："+cz.dataNode._ceshiValue+"分）";}};this.initValue=function(){if(this.dataNode._ceshiValue){var i=$$("select",en)[0];i.value=this.dataNode._ceshiValue;}};ek.appendChild(en);var dw=$ce("span","<a onclick='cur.copyScore(this);' class='titlelnk' href='javascript:'>复制分数</a>",ek);dw.style.display="none";this.copyScore=function(i){PDF_launch("/wjx/design/applyscore.aspx?ct="+cz.dataNode._topic,500,240,null,"批量复制分数");};if(cG){var eo=$ce("span","&nbsp;答案：",ek);var el=control_text("14");eo.appendChild(el);$ce("span","<a title='如果有多个答案，请以“|”分隔' href='javascript:void(0);'  onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>&nbsp;&nbsp;",eo);el.value=m._answer;el.onfocus=function(){if(this.value=="请设置答案"){this.value="";}};el.onchange=el.onblur=function(){if(this.value==""){this.value="请设置答案";}cz.dataNode._answer=this.value;cz.spanCeShi.innerHTML="（答案："+this.value+"，分值："+cz.dataNode._ceshiValue+"分）";};el.onchange();var j=control_check();eo.appendChild(j);$ce("span","<b>包含答案即可得分</b><a title='用户提交的答案不需要跟设置的答案完全一样，只要包含设置的答案就可得分。' href='javascript:void(0);' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>",eo);j.onclick=function(){if(!vipUser){alert("此功能只对企业版用户开放，请升级！");this.checked=false;return;}cz.dataNode._include=this.checked;};j.checked=m._include;}var ei=$ce("span","&nbsp;&nbsp;答案解析<a title='您可以填写针对此题答案的一些解析说明，在用户参与完测试后会看到此解析' href='javascript:void;' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>：",ek);var eh=control_text("14");ei.appendChild(eh);eh.value=m._ceshiDesc;eh.onchange=eh.onblur=function(){cz.dataNode._ceshiDesc=this.value;};eh.onchange();eh.style.display="none";$ce("span","&nbsp;",ek);var eq=$ce("a","设置答案解析",ek);eq.href="javascript:void(0)";eq.className="link-U666";eq.onclick=function(){if(!vipUser){alert("此功能只对企业版用户开放，请升级！");return;}openTitleEditor(eh,function(i){if(i=="-1nc"||i==undefined){return;}eh.value=trim(i);eh.onchange();});};this.initValue();};}var c1=document.createElement("div");c1.style.marginLeft="15px";var ad=m._title=="请在此输入问题标题"||m._title=="请根据您的实际情况选择最符合的项：1-->5表示非常不满意-->非常满意";var ck=$ce("div","",c1);if(M){c1.style.display="none";}var c=m._title.indexOf("<")>-1;if(!c){var ab=$ce("div","<span style='float:left;'>&nbsp;<b style='font-size:14px;'>题目标题</b></span>",ck);ab.style.background="#F0F0EE";ab.style.height="27px";ab.style.lineHeight="27px";ab.style.width="400px";var bA=$ce("span","",ab);bA.className="spanRight";var d6=$ce("a","设置标题字体、插入图片视频",bA);d6.href="javascript:void(0);";d6.className="link-U666";d6.onclick=function(){cz.createEditBox();};var bN=$ce("a","<b>(?)</b>",bA);bN.style.color="green";bN.href="javascript:void(0);";bN.onmouseover=function(){toolTipLayer.style.width="400px";toolTipLayer.innerHTML='<img width="400" height="152" src="/Images/Mysojump/QuestionnaireMng/Design/edit_pic.jpg">';sb_setmenunav(toolTipLayer,true,this);};bN.onmouseout=function(){sb_setmenunav(toolTipLayer,false,this);};$ce("div","",ab).className="divclear";}var bq=$ce("div","",ck);bq.style.width="395px";var G=control_textarea("4","29");G.tabIndex=1;if(ad){G.defValue=m._title;}if(ec){G.title="例如：您最喜欢的车型？";G.value=m.title;}if(bu){G.title="您可以在此输入本页的页面标题信息（选填）";}if(F){G.title="请在此输入内容";G.value=m.title;var c8=$ce("div","<a href='javascript:'>插入视频</a>(支持手机与电脑播放)<a href='/help/help.aspx?helpid=229' style='color:green;font-weight:bold;' target='_blank'>(?)</a>",ck);c8.style.marginTop="10px";var bk=$$("a",c8)[0];var t=control_text("50");var dI=$ce("div","",ck);dI.style.marginTop="5px";dI.appendChild(t);bk.onclick=function(){t.style.display=t.style.display=="none"?"":"none";};t.value=m._video||"";t.style.display=m._video?"":"none";t.onchange=function(){var dw=this.value;var j=/(https?:\/\/[^\s\"\']+)/g;var i=dw.match(j)||"";this.value=i;cz.dataNode._video=i;cz.checkTitle();};}var w="tc"+m._type+getEditorIndex();G.value=m._title;G.id=w;G.style.overflow="auto";G.style.padding="5px 0 0 5px";G.style.border="1px solid #ccc";bq.appendChild(G);if(ec){G.style.width="395px";if(!c){G.style.height="70px";}else{G.style.height="102px";}}else{G.style.width="495px";G.style.height="130px";}G.onkeyup=G.onchange=function(){cz.checkTitle();};G.onfocus=function(){if(this.value=="请在此输入问题标题"||this.value=="请根据您的实际情况选择最符合的项：1-->5表示非常不满意-->非常满意"){this.value="";}};G.onblur=function(){if(!this.value&&cz.dataNode._type!="page"){this.value=this.defValue||"";cz.checkTitle();}};var bI="";if(bE){if(aI){bI="<option value='radio'>列表单选题</option><option value='toupiaocheck'>投票多选题</option>";}else{if(bn){if(!isMergeAnswer||this.isMergeNewAdded){bI="<option value='toupiaoradio'>投票单选题</option><option value='check'>多选题</option>";}else{bI="<option value='check'>多选题</option>";}}}}else{if(bQ){if(aI){bI="<option value='radio'>列表单选题</option><option value='ceshicheck'>考试多选题</option>";}else{if(bn){if(!isMergeAnswer||this.isMergeNewAdded){bI="<option value='ceshiradio'>考试单选题</option><option value='check'>多选题</option>";}else{bI="<option value='check'>多选题</option>";}}}}else{if(eb){if(aI){bI="<option value='radio'>列表单选题</option><option value='cepingcheck'>评分多选题</option>";}else{if(bn){if(!isMergeAnswer||this.isMergeNewAdded){bI="<option value='cepingradio'>评分单选题</option><option value='check'>列表多选题</option>";}else{bI="<option value='check'>列表多选题</option>";}}}}else{if(!isMergeAnswer||this.isMergeNewAdded){if(cG){bI="<option value='radio'>列表单选题</option><option value='radio_down'>下拉框单选题</option><option value='check'>多选题</option><option value='likert'>量表题</option><option value='order'>排序题</option>";}else{if(ar){if(bZ){if(cV!=303){bI+="<option value='matrix,303'>表格下拉框</option>";}if(cV!=301){bI+="<option value='matrix,301'>表格数值题</option>";}if(cV!=302){bI+="<option value='matrix,302'>表格文本框</option>";}}else{if(cV<=101){bI+="<option value='matrix,103'>矩阵单选题</option>";bI+="<option value='matrix,102'>矩阵多选题</option>";bI+="<option value='matrix,201'>矩阵文本题</option>";bI+="<option value='matrix,202'>矩阵滑动条</option>";}else{bI+="<option value='matrix,101'>矩阵量表题</option>";if(cV!=103){bI+="<option value='matrix,103'>矩阵单选题</option>";}if(cV!=102){bI+="<option value='matrix,102'>矩阵多选题</option>";}if(cV!=201){bI+="<option value='matrix,201'>矩阵文本题</option>";}if(cV!=202){bI+="<option value='matrix,202'>矩阵滑动条</option>";}}}}else{if(dT){if(!aI||aW){bI+="<option value='radio'>列表单选题</option>";}if(!cT){bI+="<option value='radio_down'>下拉框单选题</option>";}if(!bn||dQ){bI+="<option value='check'>多选题</option>";}if(!aW){bI+="<option value='likert'>量表题</option>";}if(!dQ){bI+="<option value='order'>排序题</option>";}if(aI){bI+="<option value='toupiaoradio'>投票单选题</option>";bI+="<option value='ceshiradio'>考试单选题</option>";bI+="<option value='cepingradio'>评分单选题</option>";}else{if(bn&&!dQ){bI+="<option value='toupiaocheck'>投票多选题</option>";bI+="<option value='ceshicheck'>考试多选题</option>";}}bI+="<option value='question'>问答题</option>";}}}}else{if((aI||cT)&&cV==0){bI="<option value='likert'>量表题</option><option value='check'>多选题</option><option value='toupiaoradio'>投票单选题</option><option value='cepingradio'>评分单选题</option><option value='ceshiradio'>考试单选题</option>";}else{if(bn&&!dQ){bI="<option value='toupiaocheck'>投票多选题</option>";bI+="<option value='ceshicheck'>考试多选题</option>";}}}}}}if(bI){bI="<select style='width:90px;' onchange='javascript:cur.selChangeType(this.value);'><option value='0'>转换题型</option>"+bI+"</select>";}if(ec){setFloat(ck);var dN=$ce("div","",c1);if(cR){dN.style.display="none";}this.getQType=function(){var i=cz.dataNode._type;if(i=="question"){return"文本题";}else{if(i=="gapfill"){return"填空题";}else{if(i=="radio"){if(cz.dataNode._isTouPiao){return"投票单选题";}else{if(cz.dataNode._isCeShi){return"考试单选题";}else{if(cz.dataNode._isCePing){return"评分单选题";}else{if(cV){return"量表题";}else{if(cz.dataNode._isQingJing){return"情景随机题";}}}}}return"单选题";}else{if(i=="radio_down"){return"下拉框单选";}else{if(i=="check"){if(cz.dataNode._isTouPiao){return"投票多选题";}else{if(cz.dataNode._isCeShi){return"考试多选题";}else{if(cz.dataNode._isCePing){return"评分多选题";}else{if(cV){return"排序题";}}}}return"多选题";}else{if(i=="fileupload"){return"上传文件题";}else{if(i=="matrix"){if(cV==201){return"矩阵文本题";}else{if(cV==202){return"矩阵滑动条";}else{if(cV==301){return"表格数值题";}else{if(cV==302){return"表格文本题";}else{if(cV==303){return"表格下拉框";}else{if(az){return"矩阵量表题";}else{if(cV==103){return"矩阵单选题";}else{if(cV==102){return"矩阵多选题";}}}}}}}}}else{if(i=="sum"){return"比重题";}}}}}}}}return"";};setFloat(dN);if(bI){var ay=$ce("div","",dN);var aU=this.getQType();var bd=aU;if(aU){aU="&nbsp;&nbsp;当前题型：<b>"+aU+"</b>";}ay.innerHTML=aU+"&nbsp;&nbsp;"+bI;this.selChangeType=function(j,i){if(j=="0"){return;}if(j=="question"){if(confirm("转换成问答题将丢失所有选项信息，是否继续？")==false){return;}}changeQ(j);window.focus();};if(bd=="考试单选题"||bd=="评分单选题"||bd=="量表题"){var am=false;var bM=0;var bb=cz.dataNode._topic;for(var dF=0;dF<questionHolder.length;dF++){var I=questionHolder[dF].dataNode;var af=I._type;if(af=="cut"||af=="page"){continue;}var d1=I._topic;if(d1-bb<=0){continue;}if(I._type!="radio"){break;}bM++;}if(bM>=2){am=true;}if(am){var E=$ce("span","&nbsp;&nbsp;<a href='javascript:void(0);' class='link-U00a6e6' title='批量复制此题的题型到后面的题目'>批量复制</a>",ay);E.onclick=function(){var i="/wjx/design/applyqtype.aspx";var j=cz.dataNode._topic;i+="?ct="+j;PDF_launch(i,500,240,null,"批量复制此题的题型到后面的题目");};}}}var d3=$ce("div","",dN);d3.innerHTML="&nbsp;&nbsp;";var l=control_check();l.title="用户在填写问卷时必须回答这道题";var dr=document.createTextNode("必答题");d3.appendChild(l);d3.appendChild(dr);var W=document.createElement("span");W.style.display="none";W.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;将所有题目设为：<b><a href='javascript:setAllRequired(true);' class='link-U00a6e6'>必答</b></a>&nbsp;<a href='javascript:setAllRequired(false);' class='link-U00a6e6'><b>非必答</b></a>";d3.appendChild(W);l.onclick=function(){cz.dataNode._requir=this.checked;cz.setreqstatus();W.style.display="";};this.get_requir=function(){return l;};var e=document.createElement("div");e.innerHTML="&nbsp;&nbsp;";var aA=control_check();e.appendChild(aA);var bo=document.createTextNode("填写提示");e.appendChild(bo);var cM=$ce("span","&nbsp;",e);var dY=control_text("15");cM.appendChild(dY);$ce("span","&nbsp;",cM);var V=$ce("a","高级编辑模式",cM);V.href="javascript:void(0)";cM.style.display="none";var bj=false;aA.onclick=function(){cM.style.display=this.checked?"":"none";if(!this.checked){cz.dataNode._oldins=dY.value;dY.value="";}else{dY.value=cz.dataNode._oldins||"";}dY.onchange();};V.onclick=function(){openTitleEditor(dY,function(i){if(i=="-1nc"||i==undefined){return;}dY.value=trim(i);dY.onchange();});};dY.onchange=dY.onblur=function(){this.value=replace_specialChar(this.value);if(dY.value.length>0){cz.get_div_ins().innerHTML=subjectInfo+this.value;cz.get_div_ins().style.visibility="visible";}else{cz.get_div_ins().style.visibility="hidden";}cz.dataNode._ins=this.value;if(this.value.indexOf("<")>-1){this.style.display="none";V.innerHTML="编辑填写提示";}else{this.style.display="";V.innerHTML="高级编辑模式";}if(cz.checkTextJump){cz.checkTextJump(this.value);}};dN.appendChild(e);var a8=$ce("div","",dN);a8.innerHTML="&nbsp;&nbsp;";var bT=control_check();var cg=document.createTextNode("无条件跳题");var cX=document.createElement("span");cX.style.display="none";var cf=document.createElement("span");cf.innerHTML="，填写此题后跳转到第";var bD=control_text("3");bD.onclick=function(){openJumpWindow(cz,this,true);bD.openJumped=true;};bD.onmouseout=function(){sb_setmenunav(toolTipLayer,false);};bD.onmouseover=function(){if(!this.error){if(!this.title||this.hasChanged){this.title=getJumpTitle(this.value);}}};var ce=document.createElement("span");ce.innerHTML="题";cX.appendChild(cf);cX.appendChild(bD);cX.appendChild(ce);a8.appendChild(bT);a8.appendChild(cg);a8.appendChild(cX);var bV=$ce("a","<b>(?)</b>",a8);bV.style.color="green";bV.href="javascript:void(0);";bV.onmouseover=function(){toolTipLayer.style.width="250px";toolTipLayer.innerHTML="通过配合设置其他题目的“按选项跳题”实现更复杂的跳题逻辑 <a target='_blank' class='link-U00a6e6' href='/help/help.aspx?helpid=218&h=1'>查看示例</a>";sb_setmenunav(toolTipLayer,true,this);};bV.onmouseout=function(){sb_setmenunav(toolTipLayer,false,this);};bT.onclick=function(){if(this.checked){if(bP&&bP.value!=""){if(confirm("设置跳转逻辑将清空本题的默认值，是否继续？")){bP.value="";cz.dataNode._default="";bY.value="";}else{this.checked=false;}}if(cZ&&cZ.checked){cZ.click();}if(!l.checked){show_status_tip("由于设置了无条件跳题，建议将此题设为必答",4000);}}if(cz.defaultCheckSet){cz.defaultCheckSet();}if(bP){bP.disabled=this.checked;}cX.style.display=this.checked?"":"none";cz.dataNode._anytimejumpto=cz.dataNode._anytimejumpto=="0"?"":cz.dataNode._anytimejumpto;if(this.checked&&cz.dataNode._anytimejumpto){cz.dataNode._hasjump=true;}else{if(!this.checked){cz.dataNode._hasjump=false;}}cz.set_jump_ins();bD.value=cz.dataNode._anytimejumpto;};bD.onblur=function(){if(this.value==this.prevValue){this.hasChanged=false;return;}this.hasChanged=true;this.prevValue=this.value;cz.checkAnyJump(true);cz.set_jump_ins();};$ce("div","",c1).style.clear="both";var k=$ce("div","",dN);k.innerHTML="&nbsp;&nbsp;";var cv=control_check();var b1=document.createElement("span");b1.innerHTML="<b>关联逻辑</b>：<span style='color:#666;'>当前面题目选中某些选项时才出现此题</span>";var ea=document.createElement("span");var a6=document.createElement("a");a6.innerHTML="设置关联逻辑";a6.href="javascript:void(0);";function aL(){cur.dataNode._relation=currentRelation||"";cur.displayRelation();}ea.appendChild(a6);cz.initRelation=function(){this.dataNode._relation="";a6.innerHTML="设置关联逻辑";cv.checked=false;if(cz.RelationIns){cz.RelationIns.style.display="none";}ea.style.display="none";b1.style.display="";if(bz){bz.style.display="none";}};cz.displayRelation=function(){var j=this.dataNode._relation;if(!j){this.initRelation();return;}else{if(j=="0"){cv.checked=true;return;}}cv.checked=true;var i=this.getRelation();if(i){a6.innerHTML=i[0];a6.title=i[1];cz.RelationIns.innerHTML=i[0];cz.RelationIns.title=i[1];cz.RelationIns.style.display="";b1.style.display="none";ea.style.display="";bz.style.display="";bz.onclick=function(){var eh="/wjx/design/applyrelation.aspx";var ei=cz.dataNode._topic;eh+="?ct="+ei;var dw=cz.dataNode._relation;if(dw){eh+="&rt="+dw;}PDF_launch(eh,500,320);};}};a6.onclick=function(){var j="/wjx/design/setrelation.aspx";var dw=cz.dataNode._topic;if(dw=="1"){show_status_tip("第1题不能设置关联逻辑",5000);cv.checked=false;return;}j+="?ct="+dw;var i=cz.dataNode._relation;if(i){j+="&rt="+i;}currentRelation=i||"";PDF_launch(j,500,320,aL);};cv.onclick=function(){if(!this.checked){cz.initRelation();return;}else{a6.onclick();}};k.appendChild(cv);k.appendChild(b1);k.appendChild(ea);var bs=$ce("span","<a href='/help/help.aspx?helpid=216&h=1' target='_blank' style='color:green;'><b>(?)</b></a>",k);var bz=$ce("span","&nbsp;&nbsp;<a href='javascript:void(0);' class='link-U00a6e6'>复制到后面的题目</a>",k);bz.style.display="none";this.displayRelation();}if(dV){var cO=$ce("div","",dN);cO.style.marginLeft="13px";var dl=control_check();cO.appendChild(dl);dl.onclick=function(){cz.dataNode._useTextBox=this.checked;cz.checkTitle();};$ce("span","文本框样式&nbsp;&nbsp;",cO);var U=document.createElement("a");U.innerHTML="<b>插入填空</b>";U.className="link-U00a6e6";U.href="javascript:void(0);";U.title="填空用连续超过三个的下划线'_ _ _'表示";U.onclick=function(){if(KE.g[w].wyswygMode){KE.util.focus(w);KE.util.selection(w);KE.util.insertHtml(w,GapFillStr);KE.util.focus(w);}};cO.appendChild(U);}aB.appendChild(c1);aF.appendChild(aB);if(bu){var dq=document.createElement("span");dq.innerHTML="此页是否是甄别页：";dq.title="可以在此页设置筛选规则，如果用户提交的答卷不符合要求，则会终止后面的答题";var s=control_check();s.title=dq.title;s.onclick=function(){cz.dataNode._iszhenbie=this.checked;cz.divZhenBie.style.display=this.checked?"":"none";};c1.appendChild(dq);c1.appendChild(s);var dZ=$ce("a","(?)",c1);dZ.href="javascript:void(0);";dZ.style.color="green";dZ.style.fontWeight="bold";dZ.onmouseover=function(){toolTipLayer.style.width="250px";toolTipLayer.innerHTML="可以对此页的题目设置无效答卷筛选规则，用户点击下一页时，如果此页的答题不符合要求，系统会终止该用户继续答题。<a href='/help/help.aspx?helpid=76' target='_blank'>如何设置筛选规则？</a>";sb_setmenunav(toolTipLayer,true,this);};dZ.onmouseout=function(i){sb_setmenunav(toolTipLayer,false,this);};var bC=!vipUser&&!window.isPromote;if(bC){dq.style.display=s.style.display=dZ.style.display="none";}var ae=document.createElement("div");ae.style.margin="10px 0 0 15px";aB.appendChild(ae);var cW=document.createElement("div");cW.style.margin="10px 0 0 15px";$ce("span","<b>填写时间控制</b>&nbsp;",cW);aB.appendChild(cW);var bm=control_text(3);$ce("span","此页允许停留时间为：<b>最短</b>",cW).appendChild(bm);var dy=control_text(3);var f=$ce("span","秒&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>最长</b>",cW);f.appendChild(dy);$ce("span","秒（空表示不限制）",cW);bm.parDiv=cz;bm.onblur=bm.onchange=function(){var dw=this;var eh=dw.value;var j=this.parDiv;var ei=j.dataNode._maxtime;j.dataNode._istimer=false;if(eh){if(isPositive(eh)&&(!ei||(eh-ei<=0))){if(ei&&eh-ei==0){j.dataNode._istimer=true;}j.dataNode._mintime=parseInt(eh);}else{show_status_tip("最短时间必须为正整数并且少于最长时间",4000);dw.value="";j.dataNode._mintime="";}}else{j.dataNode._mintime="";}var i=j.dataNode._mintime||j.dataNode._maxtime;ca.style.display=(window.isPromote||vipUser)&&i?"":"none";j.showTimeLimit();};bm.onclick=function(){if(!vipUser){alert("只有企业版用户才能设置每页最短填写时间，请升级！");this.value="";this.blur();return;}};dy.onclick=function(){if(!vipUser){alert("只有企业版用户才能设置每页最长填写时间，请升级！");this.value="";this.blur();return;}};dy.onblur=dy.onchange=function(){var dw=this;var eh=dw.value;var j=cur.dataNode._mintime;cur.dataNode._istimer=false;if(eh){if(isPositive(eh)&&(!j||(eh-j>=0))){if(j&&eh-j==0){cur.dataNode._istimer=true;}cur.dataNode._maxtime=parseInt(eh);}else{show_status_tip("最长时间必须为正整数并且大于最短时间",4000);dw.value="";}}else{cur.dataNode._maxtime="";}var i=cur.dataNode._mintime||cur.dataNode._maxtime;ca.style.display=(window.isPromote||vipUser)&&i?"":"none";cz.showTimeLimit();};cz.setMinMaxTime=function(){if(bm){bm.value=this.dataNode._mintime;}if(dy){dy.value=this.dataNode._maxtime;}};var cj=$ce("a","(?)",cW);cj.href="javascript:void(0);";cj.style.color="green";cj.style.fontWeight="bold";cj.onmouseover=function(){toolTipLayer.style.width="250px";toolTipLayer.innerHTML="说明：从进入此页开始计时，在还未达到最短填写时间时不能进入下一页或提交答卷，当到达最长填写时间后还未做答完成将自动跳转到下一页或提交答卷。如果要控制用户观看图片或者视频的时间，可以设置最短填写时间等于最长填写时间，<a href='http://www.sojump.com/jq/3690298.aspx' target='_blank' class='titlelnk'>查看示例问卷</a>";sb_setmenunav(toolTipLayer,true,this);};cj.onmouseout=function(i){sb_setmenunav(toolTipLayer,false,this);};var ca=$ce("div","将上面的填写时间复制到&nbsp;",cW);ca.style.marginLeft="83px";var ap=1;var x=1;var Z=total_page;$ce("span","<input type='radio'  name='rbltimesp' onclick='cur.setTimePageTime(1);'  checked='checked'  />所有页<input type='radio' name='rbltimesp'  onclick='cur.setTimePageTime(2);'/>指定页",ca);var L=$ce("span","：第<input type='text' value='1' onblur='cur.setTimePageStart(this);' style='width:20px;'/>页到<input type='text' value='"+Z+"' onblur='cur.setTimePageEnd(this);' style='width:20px;'/>页",ca);L.style.display="none";cz.setTimePageTime=function(i){ap=i;L.style.display=i==1?"none":"";};cz.setTimePageStart=function(i){var j=i.value;if(!isPositive(j)||j-Z>=0){i.value=1;show_status_tip("必须为正数，并且小于最大页数",4000);}x=i.value;};cz.setTimePageEnd=function(i){var j=i.value;if(!isPositive(j)||j-total_page>0){i.value=total_page;show_status_tip("必须为正数，并且小于总页数",4000);}else{if(j-x<=0){i.value=total_page;show_status_tip("必须大于最小页数",4000);}}Z=i.value;};var d7=$ce("span","&nbsp;",ca);var aH=control_btn("复制");aH.className="operation";d7.appendChild(aH);aH.onclick=function(){if(ap==1){Z=total_page;}ds(firstPage);for(var j=0;j<questionHolder.length;j++){ds(questionHolder[j]);}show_status_tip("成功复制",4000);};var c6=$ce("div","",aB);c6.style.margin="10px 0px 0px 15px";if(!vipUser&&!window.isPromote){c6.style.display="none";}$ce("span","<b>批量插入分页符</b>&nbsp;",c6);var ef=$ce("span","每隔",c6);var a9=control_text(3);a9.value="1";ef.appendChild(a9);$ce("span","题插入一个分页符",ef);a9.maxlength=2;a9.onblur=a9.onchange=function(){if(!isPositive(this.value)){this.value=1;}};var da=1;var a0=1;var dm=total_question;$ce("span","&nbsp;&nbsp;&nbsp;应用范围：<input type='radio' name='rblPageScope' onclick='cur.setInsertScopeType(1);' checked='checked'/>全部题<input type='radio' name='rblPageScope' onclick='cur.setInsertScopeType(2);'/>指定题",c6);var n=$ce("span","&nbsp;第<input type='text' style='width:20px;' value='1' onblur='cur.setInsertMinPage(this);'>题至第<input type='text' style='width:20px;'  onblur='cur.setInsertMaxPage(this);' value='"+dm+"'>题",c6);n.style.display="none";cz.setInsertScopeType=function(i){da=i;n.style.display=i==1?"none":"";};cz.setInsertMinPage=function(i){var j=i.value;if(!isPositive(j)||j-dm>=0){i.value=1;show_status_tip("必须为正数，并且小于最大题数",4000);}a0=i.value;};cz.setInsertMaxPage=function(i){var j=i.value;if(!isPositive(j)||j-total_question>0){i.value=total_question;show_status_tip("必须为正数，并且小于总题数",4000);}else{if(j-a0<=0){i.value=total_question;show_status_tip("必须大于最小题数",4000);}}dm=i.value;};var eg=$ce("span","",c6);var S=control_btn("批量插入");S.className="operation";eg.appendChild(S);$ce("span","&nbsp;",eg);var cb=control_btn("删除");cb.className="operation";cb.title="删除除第一页之外的所有分页";eg.appendChild(cb);cb.onclick=function(){if(confirm("确定删除除第一页之外的所有分页吗？")){var eh=new Array();for(var j=0;j<questionHolder.length;j++){var dw=questionHolder[j].dataNode;if(dw._type=="page"){eh.push(questionHolder[j]);}}for(var j=0;j<eh.length;j++){eh[j].deleteQ("noNeedConfirm");}}};S.onclick=function(){var ej=new Array();for(var ei=0;ei<questionHolder.length;ei++){var el=questionHolder[ei].dataNode;questionHolder[ei].pageNext=false;if(el._type!="page"&&el._type!="cut"){ej.push(questionHolder[ei]);}else{if(el._type=="page"){if(ei>0){questionHolder[ei-1].pageNext=true;}}}}var j=ej.length;if(j>1){var dw=parseInt(a9.value);var em=(a0-1)||dw-1;if(da==1){dm=total_question;}for(var ei=em;ei<dm-1;ei+=dw){var ek=questionHolder[ei+1];if(ej[ei].pageNext){continue;}var eh=createFreQdataNode("page");addNewQ(eh,false,false,ej[ei]);}}else{show_status_tip("最后一题不需要添加分页",4000);}};function ds(j){var dw=j.dataNode;if(dw._type=="page"){var i=parseInt(dw._topic);if(i>=x&&i<=Z){dw._mintime=cur.dataNode._mintime;dw._maxtime=cur.dataNode._maxtime;if(j.setMinMaxTime){j.setMinMaxTime();}}}}}if(dT||u){var a7="<a href='javascript:cur.show_divAddFromCheck();' class='link-U666' title='引用其它题的选中项'>引用其它题选中项</a>&nbsp;";var T=document.createElement("div");T.style.margin="10px 0px";var bp=$ce("select","",T);bp.style.width="220px";T.style.display="none";var d5=document.createElement("div");d5.style.display="none";d5.style.margin="10px 0";this.show_divAddFromCheck=function(){if(!T.inited){bp.onchange=function(){if(!vipUser){alert("只有企业版用户才能使用引用逻辑，请升级！");this.value="0";return;}cur.addFromCheck(this);};T.inited=true;$ce("label","&nbsp;<a target='_blank' href='/help/help.aspx?helpid=217&h=1' style='color:green;text-decoration:underline;'><b>帮助</b></a>",T);}T.style.display=T.style.display==""?"none":"";if(isMergeAnswer&&!this.isMergeNewAdded){T.style.display="none";}if(ar){if(bL){bL.style.display=T.style.display==""?"none":"";}if(dh&&!dh.checked){bL.style.display="none";}if(bp.value>0&&bL){bL.style.display="none";}}this.updateSelCheck();this.hasDisplaySelCheck=T.style.display=="";};this.updateSelCheck=function(){for(var ei=0;ei<bp.options.length;ei++){bp.options[ei]=null;}bp.options[0]=new Option("请选择来源题目(多选或排序题)",0);var em=1;for(var ei=0;ei<questionHolder.length;ei++){var el=questionHolder[ei].dataNode;var eo=this.dataNode._topic;if(el._type=="check"&&el._topic-eo<0&&!questionHolder[ei]._referDivQ){var dw="[多选题]";if(el._tag){dw="[排序题]";}var eh=el._title;eh=eh.replace(/<(?!img|embed).*?>/ig,"");eh=eh.replace(/&nbsp;/ig," ").substring(0,16);var ek=eh+"  "+dw;if(!WjxActivity._use_self_topic){ek=el._topic+"."+ek;}var ej=new Option(ek,el._topic);ej.referDivQ=questionHolder[ei];bp.options[em++]=ej;}}if(this._referDivQ){var en=bp.options;for(var ei=0;ei<en.length;ei++){var j=en[ei];if(j.referDivQ==this._referDivQ){bp.value=j.value;break;}}}};this.addFromCheck=function(ej){var eh=bp.selectedIndex;if(aI||bn){if(eh>0&&b5.checked){b5.checked=false;b5.onclick();}b5.disabled=eh>0?true:false;cp.style.display=eh>0?"none":"";}else{ed.style.display=eh>0?"none":"";if(aE){aE.style.display=ed.style.display;}}d5.style.display=eh>0?"":"none";this.clearReferQ();if(bp.value>0){if(this._referedArray){var dw="";for(var ei=0;ei<this._referedArray.length;ei++){if(ei>0){dw+=",";}dw+=this._referedArray[ei].dataNode._topic;}show_status_tip("第"+dw+"题的选项或行标题来源于此题的选中项，此题不能再引用其他题");bp.value="0";this.show_divAddFromCheck();return;}var j=bp.options[bp.selectedIndex].referDivQ;this._referDivQ=j;if(!j._referedArray){j._referedArray=new Array();}if(j._referedArray.indexOf(this)==-1){j._referedArray.push(this);}j._referedArray.sort(function(ek,i){return ek.dataNode._topic-i.dataNode._topic;});this.updateReferQ();}else{this.show_divAddFromCheck();}if(this.dataNode._daoZhi){if(cE){cE.checked=false;this.dataNode._daoZhi=false;cz.updateSpanMatrix();show_status_tip("使用引用逻辑后，不能再使用竖向选择",5000);}}if(this.updateItem){this.updateItem();}else{if(this.createSum){this.createSum();}}};this.removeRefer=function(){bp.value="0";this.addFromCheck();};this.clearReferQ=function(){if(this._referDivQ){this._referDivQ._referedArray.remove(this);if(!this._referDivQ._referedArray.length){this._referDivQ._referedArray=null;}this._referDivQ=null;}};this.clearReferedQ=function(){if(this._referedArray){for(var j=0;j<this._referedArray.Length;j++){var dw=this._referedArray[j];dw._referDivQ=null;if(dw.updateItem){dw.updateItem();}else{if(dw.createSum){dw.createSum();}}}}};this.updateReferQ=function(){if(this._referDivQ){var i=this._referDivQ;var dw="选项";if(this.dataNode._type=="matrix"||this.dataNode._type=="sum"){dw="行标题";}var j="，<a href='javascript:cur.removeRefer();' class='link-U00a6e6'>取消引用</a>";if(isMergeAnswer&&!this.isMergeNewAdded){j="";}d5.innerHTML=dw+"来源于第"+i.dataNode._topic+"题的选中项"+j;}};}if(ec){$ce("div","",aB).style.clear="both";var db=document.createElement("div");db.style.marginLeft="15px";if(!dT){var dR=document.createElement("div");dR.style.margin="10px 0";db.appendChild(dR);}aB.appendChild(db);}if(ch){$ce("span","最小值：",dR);var aG=control_text("3");aG.title="用户可以选择的最小值";aG.maxLength=4;dR.appendChild(aG);$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;最小值显示文本：",dR);var cc=control_text("10");dR.appendChild(cc);var bJ=document.createElement("br");dR.appendChild(bJ);$ce("span","最大值：",dR);var d=control_text("3");d.title="用户可以选择的最大值";d.maxLength=4;dR.appendChild(d);$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;最大值显示文本：",dR);var aq=control_text("10");dR.appendChild(aq);aG.onchange=aG.onblur=function(){var i=100;if(!isInt(this.value)||this.value-d.value>0){show_status_tip("最小值不合法",4000);i=(0-d.value<0)?0:toInt(d.value)-1;}else{i=toInt(this.value);}cz.dataNode._minvalue=i;this.value=i;cz.get_span_min_value().innerHTML="("+i+")";};d.onchange=d.onblur=function(){if(!isInt(this.value)||this.value-aG.value<0){show_status_tip("最大值不合法",4000);val=(100-aG.value>0)?100:toInt(aG.value)+1;}else{val=toInt(this.value);}cz.dataNode._maxvalue=val;this.value=val;cz.get_span_max_value().innerHTML="("+val+")";};cc.onchange=cc.onblur=function(){this.value=replace_specialChar(this.value);cz.get_span_min_value_text().innerHTML=cz.dataNode._minvaluetext=this.value;};aq.onchange=aq.onblur=function(){this.value=replace_specialChar(this.value);cz.get_span_max_value_text().innerHTML=cz.dataNode._maxvaluetext=this.value;};}if(d2){dR.innerHTML="<span style='font-size:10px'>●&nbsp;</span>";$ce("span","上传文件允许的最大文件大小(KB)：",dR);var J=control_text("8");var dB=fileMaxSize/1024;J.maxLength=5;dR.appendChild(J);$ce("span","&nbsp;不能超过"+fileMaxSize+"KB("+dB+"M)",dR);J.onblur=J.onchange=function(){var i=J.value;if(i){if(isPositive(i)&&i-fileMaxSize<=0){cz.dataNode._maxsize=i;}else{cz.dataNode._maxsize=fileMaxSize;show_status_tip("最大文件大小必须为正数，并且不能超过"+fileMaxSize+"KB（即"+dB+"M）",3000);this.value="";}}else{cz.dataNode._maxsize=fileMaxSize;}cz.updateFileUpload();};$ce("br","",dR);$ce("span","<span style='font-size:10px'>●&nbsp;</span>上传文件允许的扩展名：",dR);var ak="<div><b>&nbsp;&nbsp;图片文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.gif'/>.gif&nbsp;<input type='checkbox' value='.png'/>.png&nbsp;<input type='checkbox' value='.jpg'/>.jpg&nbsp;<input type='checkbox' value='.jpeg'/>.jpeg&nbsp;<input type='checkbox' value='.bmp'/>.bmp&nbsp;</div>";ak+="<div><b>&nbsp;&nbsp;文档文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.doc'/>.doc&nbsp;<input type='checkbox' value='.docx'/>.docx&nbsp;<input type='checkbox' value='.pdf'/>.pdf&nbsp;<input type='checkbox' value='.xls'/>.xls&nbsp;<input type='checkbox' value='.xlsx'/>.xlsx&nbsp;<input type='checkbox' value='.ppt'/>.ppt&nbsp;<input type='checkbox' value='.pptx'/>.pptx&nbsp;<input type='checkbox' value='.txt'/>.txt&nbsp;</div>";ak+="<div><b>&nbsp;&nbsp;压缩文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.rar'/>.rar&nbsp;<input type='checkbox' value='.zip'/>.zip&nbsp;<input type='checkbox' value='.gzip'/>.gzip</div><div style='margin-top:10px;'>&nbsp;&nbsp;提示：用户上传的文件在您不删除的情况下默认会保存5年时间。</div>";var dS=$ce("div",ak,dR);cz.updateExt=function(eh){var i=$$("input",dS);var dw="";for(var j=0;j<i.length;j++){if(i[j].checked&&i[j].value){if(dw){dw+="|";}dw+=i[j].value;}}this.dataNode._ext=dw;this.updateFileUpload();};}if(cG&&cz.dataNode._verify!="多级下拉"){if(bQ){var bU=document.createElement("div");db.appendChild(bU);this.addCeShiSetting(bU);}var cQ=this.get_span_maxword();var bY=this.get_textarea();var bF=$ce("span","高度：",dR);var dK="<select onchange='cur.setTHeight(this);'><option value='1'>1行</option><option value='2'>2行</option><option value='3'>3行</option><option value='4'>4行</option><option value='5'>5行</option><option value='10'>10行</option><option value='自定义'>自定义</option></select>&nbsp;";bF.innerHTML+=dK;var de=$ce("span","",dR);var aM=control_text("3");aM.maxLength=3;aM.onchange=aM.onblur=function(){var i=this.value;if(!isEmpty(i)&&!isInt(i)){show_status_tip("您输入的高度不合法！");this.value="";cz.dataNode._height="1";}else{cz.dataNode._height=i?parseInt(i):"";}cz.showTextAreaHeight();};this.setTHeight=function(i){if(i.value!="自定义"){aM.value=i.value;de.style.display="none";aM.onchange();}else{de.style.display="";}};this.initHeight=function(){if(this.dataNode._height){var i=$$("select",bF)[0];i.value=this.dataNode._height;if(i.selectedIndex==-1){i.value="自定义";this.setTHeight(selWidth);}}};de.style.display="none";de.appendChild(aM);de.appendChild(document.createTextNode("行"));var cy=$ce("span","&nbsp;&nbsp;宽度：",dR);var cJ="<select onchange='cur.setTWidth(this);'><option value=''>默认</option><option value='50'>50</option><option value='100'>100</option><option value='200'>200</option><option value='300'>300</option><option value='400'>400</option><option value='500'>500</option><option value='600'>600</option><option value='自定义'>自定义</option></select>&nbsp;";cy.innerHTML+=cJ;var aT=control_text("5");aT.maxLength=3;aT.onchange=aT.onblur=function(){var i=this.value;if(!isEmpty(i)&&!isInt(i)){show_status_tip("您输入的宽度不合法！");this.value="";cz.dataNode._width="";}else{cz.dataNode._width=i?parseInt(i):"";if(i=="1"&&cz.dataNode._requir){l.click();}}cz.showTextAreaWidth();};this.setTWidth=function(i){if(i.value!="自定义"){aT.value=i.value;aT.style.display="none";aT.onchange();}else{aT.style.display="";}};this.initWidth=function(){if(this.dataNode._width){var i=$$("select",cy)[0];i.value=this.dataNode._width;if(i.selectedIndex==-1||this.dataNode._width=="1"){i.value="自定义";this.setTWidth(i);}}};dR.appendChild(cy);aT.style.display="none";dR.appendChild(aT);var N=$ce("span","&nbsp;&nbsp;",dR);var cm=control_check();N.appendChild(cm);N.appendChild(document.createTextNode("下划线样式"));cm.onclick=function(){cz.dataNode._underline=this.checked;cz.showTextAreaUnder();};var aR=$ce("span","&nbsp;&nbsp;",dR);var A=control_check();aR.appendChild(A);var cI="默认值";var cq=$ce("span",cI,aR);var bP=control_textarea("1","18");bP.style.overflow="auto";bP.style.height="15px";bP.style.display="none";A.onclick=function(){bP.style.display=bP.style.display=="none"?"":"none";if(!this.checked){cz.dataNode._olddefault=bP.value;bP.value="";}else{bP.value=cz.dataNode._olddefault||"";}bP.onchange();};aR.appendChild(bP);bP.onchange=bP.onblur=function(){if(cz.checkDefault){cz.checkDefault();}};this.changeDefaultAttr=function(i){if(this.dataNode._verify=="省市区"||this.dataNode._verify=="高校"){cq.innerHTML="指定省份";bP.onmouseover=function(){openProvinceWindow(cz,this);};bP.onmouseout=function(){sb_setmenunav(toolTipLayer,false);};}else{cq.innerHTML=cI;bP.onmouseover=bP.onmouseout=null;}if(i){bP.value="";bP.onchange();}};var c2=document.createElement("div");var b9=control_check();var cl=document.createElement("span");var aD=getVerifyHtml();cl.innerHTML=aD;c2.appendChild(cl);this.setVerify=function(j){var i=false;if(this.dataNode._verify=="省市区"||j.value=="省市区"||this.dataNode._verify=="高校"||j.value=="高校"){i=true;}this.dataNode._verify=j.value;if(this.dataNode._verify=="数字"||this.dataNode._verify=="小数"){aC.innerHTML=aC.innerHTML.replace("字数","值");aj.innerHTML=aj.innerHTML.replace("字数","值");ag="值";}else{aC.innerHTML=aC.innerHTML.replace("值","字数");aj.innerHTML=aj.innerHTML.replace("值","字数");ag="字数";}this.changeDefaultAttr(i);this.showTextAreaDate();this.showByVerify();this.showSmsVerify();};this.showByVerify=function(){var j=this.dataNode._verify;if(bx){bx.style.display=j=="手机"?"":"none";}var i=j=="数字"||j=="小数"||j=="汉字"||j=="英文"||j==""||j=="0";aY.style.display=i?"":"none";};this.initVerify=function(){var j=this.dataNode._verify||"0";var i=$$("select",cl)[0];i.value=j;this.showByVerify();};var aY=$ce("span","&nbsp;",c2);var ag="字数";if(m._verify=="数字"||m._verify=="小数"){ag="值";}var aC=$ce("span","最小"+ag+"：",aY);var au=control_text("4");au.title="不填表示无限制";aY.appendChild(au);au.onchange=au.onblur=function(){var j=this.value;var i=d8.value;if(!isEmpty(j)&&(!isInt(j)||(!isEmpty(i)&&this.value-i>0))){show_status_tip("最小"+ag+"不合法",4000);this.value="";}else{if(!isEmpty(j)&&cz.dataNode._verify!="数字"&&cz.dataNode._verify!="小数"){if(j-3000>0){show_status_tip("最小字数不能超过3000",4000);this.value="";}}}cz.dataNode._minword=this.value;cz.showMinMaxWord(i,this.value);cz.checkDefault();};var aj=$ce("span","最大"+ag+"：",aY);aj.style.marginLeft="10px";var d8=control_text("4");d8.title="不填表示无限制";d8.onchange=d8.onblur=function(){var j=this.value;var i=au.value;if(!isEmpty(j)&&(!isInt(j)||(!isEmpty(i)&&this.value-i<0))){show_status_tip("最大字数不合法",4000);this.value="";}else{if(!isEmpty(j)&&cz.dataNode._verify!="数字"&&cz.dataNode._verify!="小数"){if(j-3000>0){show_status_tip("最大字数不能超过3000",4000);this.value="";}}}cz.dataNode._maxword=this.value;cz.showMinMaxWord(this.value,i);cz.checkDefault();};aY.appendChild(d8);var ct=control_check();var c3=$ce("span","&nbsp;&nbsp;",c2);c3.appendChild(ct);$ce("span","不允许重复&nbsp;",c3);ct.onclick=function(){if(!vipUser){this.checked=false;alert("此功能只对企业版用户开放，请升级！");return;}cz.dataNode._needOnly=this.checked;if(this.checked&&!cz.dataNode._requir){show_status_tip("由于设置了唯一性，推荐将该题设为必答题",4000);l.click();}};ct.title="要求每个人填写的答案是唯一的";var bX=control_check();var bx=$ce("span","&nbsp;&nbsp;",c2);bx.appendChild(bX);$ce("span","使用短信验证&nbsp;&nbsp短信余额：<span style='color:red;'>"+smsBalance+"</span>，<a href='/corphome/account/prepaysms.aspx?amount=500' target='_blank' class='titlelnk'>购买</a>",bx);bX.onclick=function(){cz.dataNode._needsms=this.checked;if(this.checked&&!cz.dataNode._requir){show_status_tip("由于设置了短信验证，推荐将该题设为必答题",4000);l.click();}cz.showSmsVerify();};db.appendChild(c2);this.changeDefaultAttr();if(bQ){c2.style.display="none";}}else{if(cG&&cz.dataNode._verify=="多级下拉"){var cH="/wjx/design/setmenulist.aspx?ct="+cz.dataNode._topic;var du=$ce("span","<a class='BS_btn' href='javascript:' onclick='PDF_launch(\""+cH+"\",500,500);'>点击设置多级下拉选项</a>",dR);}}if(dV){var dC=document.createElement("div");var c7=document.createElement("span");dC.appendChild(c7);this.gapSelClick=function(ei){var eh=getGapFillCount(m._title);if(eh==ei.options.length-1){return;}ei.options.length=0;ei.options.add(new Option("请选择空","-1"));for(var dw=0;dw<eh;dw++){var j=new Option("填空"+(dw+1),dw);ei.options.add(j);}};this.refreshSelRow=function(){var ei=this.dataNode;var eh=getGapFillCount(ei._title);var dw="";var i="填空属性";if(bQ){i="答案设置";}c7.innerHTML="<b>"+i+"</b>：<select style='width:80px;' onclick='cur.gapSelClick(this);'></select>";var j=$$("select",c7)[0];this.gapSelClick(j);j.onchange=function(){var em=this.value;var el=parseInt(em);cN.style.display=el<0?"none":"";var ek=$$("select",cN)[0];if(!cz.dataNode._rowVerify||!cz.dataNode._rowVerify[el]){ek.value="0";au.value="";d8.value="";return;}ek.value=cz.dataNode._rowVerify[el]._verify||"0";au.value=cz.dataNode._rowVerify[el]._minword||"";d8.value=cz.dataNode._rowVerify[el]._maxword||"";if(cz.dataNode._isCeShi){var ej=$$("select",bh)[0];ej.value=cz.dataNode._rowVerify[el]._ceshiValue||"1";aX.value=cz.dataNode._rowVerify[el]._answer||"";cD.value=cz.dataNode._rowVerify[el]._ceshiDesc||"";ac.checked=cz.dataNode._rowVerify[el]._include||false;}};};this.refreshSelRow();dC.style.margin="10px 0 0 15px";aB.appendChild(dC);var cN=document.createElement("span");var aS=$ce("span","&nbsp;",cN);cN.style.display="none";var aD=getVerifyHtml();aS.innerHTML=aD;dC.appendChild(cN);this.setVerify=function(dw){if(!this.dataNode._rowVerify){this.dataNode._rowVerify=new Array();}var i=$$("select",c7)[0];var ei=i.value;var eh=parseInt(ei);if(!cz.dataNode._rowVerify[eh]){cz.dataNode._rowVerify[eh]=new Object();}var j=this.dataNode._rowVerify[eh]._verify;this.dataNode._rowVerify[eh]._verify=dw.value;if(dw.value=="数字"||dw.value=="小数"){aC.innerHTML=aC.innerHTML.replace("字数","值");aj.innerHTML=aj.innerHTML.replace("字数","值");ag="值";}else{aC.innerHTML=aC.innerHTML.replace("值","字数");aj.innerHTML=aj.innerHTML.replace("值","字数");ag="字数";}this.checkTitle();};this.initVerify=function(){var j=this.dataNode._verify||"0";var i=$$("select",cN)[0];i.value=j;};var aY=$ce("span","&nbsp;",cN);var ag="字数";if(m._verify=="数字"||m._verify=="小数"){ag="值";}var aC=$ce("span","最小"+ag+"：",aY);var au=control_text("4");au.title="不填表示无限制";aY.appendChild(au);au.onchange=au.onblur=function(){var ei=this.value;var j=$$("select",c7)[0];var dw=j.value;var eh=parseInt(dw);if(!cz.dataNode._rowVerify[eh]){cz.dataNode._rowVerify[eh]=new Object();}var i=checkVerifyMinMax(au,d8,cz.dataNode._rowVerify[eh]._verify);if(i){show_status_tip(i,4000);this.value="";}cz.dataNode._rowVerify[eh]._minword=this.value;};var aj=$ce("span","最大"+ag+"：",aY);aj.style.marginLeft="10px";var d8=control_text("4");d8.title="不填表示无限制";d8.onchange=d8.onblur=function(){var ei=this.value;var j=$$("select",c7)[0];var dw=j.value;var eh=parseInt(dw);if(!cz.dataNode._rowVerify[eh]){cz.dataNode._rowVerify[eh]=new Object();}var i=checkVerifyMinMax(au,d8,cz.dataNode._rowVerify[eh]._verify);if(i){show_status_tip(i,4000);this.value="";}cz.dataNode._rowVerify[eh]._maxword=this.value;};aY.appendChild(d8);if(bQ){aY.style.display="none";aS.style.display="none";var bh=$ce("span","分值：",cN);bh.style.marginLeft="15px";var dJ="<select onchange='cur.setTValue(this);'>";for(var dF=1;dF<=10;dF++){dJ+="<option value='"+dF+"'>"+dF+"</option>";}dJ+="</select>&nbsp;";bh.innerHTML+=dJ;this.setTValue=function(dw){var i=$$("select",c7)[0];var j=i.value;var eh=parseInt(j);if(!cz.dataNode._rowVerify[eh]){cz.dataNode._rowVerify[eh]=new Object();}cz.dataNode._rowVerify[eh]._ceshiValue=dw.value;cz.checkTitle();};cN.appendChild(bh);var dp=$ce("span","&nbsp;答案：",cN);var aX=control_text("8");dp.appendChild(aX);$ce("span","<a title='如果有多个答案，请以“|”分隔' href='javascript:void(0);' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>&nbsp;",dp);aX.onchange=aX.onblur=function(){this.value=this.value.replace(/｜/,"|");var eh=this.value;var i=$$("select",c7)[0];var j=i.value;var dw=parseInt(j);if(!cz.dataNode._rowVerify[dw]){cz.dataNode._rowVerify[dw]=new Object();}cz.dataNode._rowVerify[dw]._answer=this.value;cz.checkTitle();};var ac=control_check();dp.appendChild(ac);$ce("span","<b>包含答案即可得分</b><a title='用户提交的答案不需要跟设置的答案完全一样，只要包含设置的答案就可得分。' href='javascript:void(0);' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>",dp);ac.onclick=function(){if(!vipUser){alert("此功能只对企业版用户开放，请升级！");this.checked=false;return;}var i=$$("select",c7)[0];var j=i.value;var dw=parseInt(j);if(!cz.dataNode._rowVerify[dw]){cz.dataNode._rowVerify[dw]=new Object();}cz.dataNode._rowVerify[dw]._include=this.checked;};var cK=$ce("span","&nbsp;&nbsp;答案解析<a title='您可以填写针对此题答案的一些解析说明，在用户参与完测试后会看到此解析' onclick='alert(this.title);' href='javascript:void(0);' style='color:green;'><b>(?)</b></a>：",cN);var cD=control_text("10");cK.appendChild(cD);cD.style.display="none";cD.onchange=cD.onblur=function(){var eh=this.value;var i=$$("select",c7)[0];var j=i.value;var dw=parseInt(j);if(!cz.dataNode._rowVerify[dw]){cz.dataNode._rowVerify[dw]=new Object();}cz.dataNode._rowVerify[dw]._ceshiDesc=this.value;};$ce("span","&nbsp;",cN);var dG=$ce("a","设置答案解析",cN);dG.href="javascript:void(0)";dG.className="link-U666";dG.onclick=function(){if(!vipUser){alert("此功能只对企业版用户开放，请升级！");return;}openTitleEditor(cD,function(i){if(i=="-1nc"||i==undefined){return;}cD.value=trim(i);cD.onchange();});};}}if(dT){var cp=document.createElement("div");cp.style.clear="both";}var dU=false;for(var dF=0;dF<questionHolder.length;dF++){var I=questionHolder[dF].dataNode;if(I._type=="cut"||I._type=="page"){continue;}var d1=I._topic;if(d1-this.dataNode._topic<0&&I._type=="check"){dU=true;break;}else{if(d1-this.dataNode._topic>=0){break;}}}if(ar||u){var bw=document.createElement("div");bw.style.padding="10px 0 0 10px";if(ar){cp.appendChild(bw);bw.style.width="315px";if(bZ){bw.style.width="385px";}}else{db.appendChild(bw);}var dg=document.createElement("div");dg.style.marginRight="5px";bw.appendChild(dg);dg.className="matrixtitle";if(bZ){dg.style.width="186px";}if(u){bw.style.background="#D5E2F2";bw.style.width="400px";var cn=$ce("div","可分配的总比重值：",dg);var cP=control_text("3");cP.style.height="16px";cP.maxLength=3;cP.style.overflow="auto";cP.value=this.dataNode._total||"100";cn.appendChild(cP);cP.onchange=cP.onblur=function(){if(isInt(this.value)&&parseInt(this.value)>0){cz.dataNode._total=parseInt(this.value);}else{cz.dataNode._total=100;show_status_tip("可分配总比重值要大于0",4000);}this.value=cz.dataNode._total;};}var bi=ar?"左行标题":"比重评估项目";if(bZ){bi="行标题";}var b8=bZ?"16":"30";var ee=u?"4":"6";if(isMergeAnswer&&!this.isMergeNewAdded){a7="";}if(!dU){a7="";}var cd=$ce("div","<span style='float:left;'><b>"+bi+"</b>：</span>",dg);if(ar&&!bZ){var br=$ce("span","",cd);br.className="spanRight";br.style.paddingRight="20px";var dh=control_check();br.appendChild(dh);var bA=$ce("span","右行标题",br);dh.checked=m._rowtitle2?true:false;}$ce("div","",cd).className="divclear";var ed=control_textarea(ee,b8);ed.style.overflow="auto";ed.tabIndex=1;ed.value=this.dataNode._rowtitle;ed.style.margin="0px";if(!isMergeAnswer||this.isMergeNewAdded){ed.title="相当于每个小题的标题";}else{ed.oldLen=ed.value.split("\n").length;ed.oldValue=ed.value;ed.title="特别提示：有答卷的情况下只能修改文字，不能增加或删除行标题，也不能移动行标题顺序";ed.onclick=function(){if(!ed.alert){alert(ed.title);ed.alert=true;}};ed.onkeypress=function(i){var i=i||window.event;if(i.keyCode==13){alert("有答卷的情况下不能添加新行，只能修改文字内容！");if(i.preventDefault){i.preventDefault();}if(i.returnValue!==undefined){i.returnValue=false;}event.keyCode=0;return false;}};}dg.appendChild(ed);this.checkRowTitle=function(){this.popHint("");var dw="";if(trim(ed.value)==""){this.popHint(bi+"不能为空！");ed.focus();this.isRowTitleValid=false;return false;}else{var ek=ed.value.split("\n");var ej=0;for(var ei=0;ei<ek.length;ei++){if(trim(ek[ei])!=""){if(ej>0){dw+="\n";}dw+=ek[ei];ej++;}for(var eh=ei+1;eh<ek.length;eh++){if(trim(ek[ei])!=""&&trim(ek[ei])==trim(ek[eh])){this.popHint(bi+"的第"+(ei+1)+"行与第"+(eh+1)+"行重复，请修改！");this.isRowTitleValid=false;return false;}}}}var el=dw.split("\n").length;if(ed.oldLen&&el!=ed.oldLen){if(!confirm("有答卷的情况下不能增加或删除行标题，只能修改文字内容！\r\n是否还原为初始状态的值？")){this.isRowTitleValid=false;return false;}dw=ed.oldValue;}this.isRowTitleValid=true;ed.value=dw;this.dataNode._rowtitle=dw;return true;};ed.onfocus=function(){if(this.value=="外观\n功能"){this.value="";}};ed.onblur=function(){if(!this.value){this.value="外观\n功能";}cz.checkRowTitle();if(u){cz.createSum();}else{if(ar){cz.updateItem();if(cz.refreshSelRow){cz.refreshSelRow();}}}};if(ar&&!bZ){var bL=document.createElement("div");bL.style.display=dh.checked?"":"none";setFloat(bL);bw.appendChild(bL);var cA=control_check();var R=$ce("div","",bL);R.appendChild(cA);$ce("span","右行标题(可选)",R);cA.checked=dh.checked;dh.onclick=cA.onclick=function(){bL.style.display=this.checked?"":"none";ed.style.width=this.checked?"150px":"290px";dg.style.width=this.checked?"156px":"";aJ.style.display=this.checked?"":"none";dh.style.display=this.checked?"none":"";bA.style.display=this.checked?"none":"";dh.checked=cA.checked=this.checked;if(!this.checked){dv.prevValue=dv.value;dv.value="";}else{if(!dv.value){dv.value=dv.prevValue||"";}}dv.onblur();};var dv=control_textarea("6","14");bL.appendChild(dv);dv.style.overflow="auto";dv.value=this.dataNode._rowtitle2||"";dv.title="适用于“语义差异法”等场景";this.checkRowTitle2=function(){if(ar){dv.value=replace_specialChar(dv.value);this.dataNode._rowtitle2=dv.value;}return true;};dv.onblur=function(){cz.checkRowTitle2();cz.updateItem();};}if(bZ){var b=document.createElement("div");setFloat(b);bw.appendChild(b);$ce("div","<b>列标题：</b>&nbsp;",b);var aQ=control_textarea("6","16");aQ.style.overflow="auto";aQ.value=this.dataNode._columntitle;aQ.style.margin="0px";if(!isMergeAnswer||this.isMergeNewAdded){aQ.title="列标题";}else{aQ.disabled=true;aQ.title="合并答卷模式下不能更改！";}b.appendChild(aQ);aQ.onblur=function(){cz.checkColumnTitle();cz.updateItem();};this.checkColumnTitle=function(){this.popHint("");if(trim(aQ.value)==""){this.popHint("列标题不能为空！");aQ.focus();this.isColumnTitleValid=false;return false;}else{var ei=aQ.value.split("\n");for(var eh=0;eh<ei.length;eh++){for(var dw=eh+1;dw<ei.length;dw++){if(trim(ei[eh])!=""&&trim(ei[eh])==trim(ei[dw])){this.popHint("列标题的第"+(eh+1)+"行与第"+(dw+1)+"行重复，请修改！");this.isColumnTitleValid=false;return false;}}}}this.isColumnTitleValid=true;aQ.value=replace_specialChar(aQ.value);this.dataNode._columntitle=aQ.value;return true;};}$ce("div","",bw).className="divclear";this.addLabel=function(){var i="\n【标签】标签名";var j=ed.value.length;ed.focus();if(typeof document.selection!="undefined"){document.selection.createRange().text=i;}else{ed.value=ed.value.substr(0,ed.selectionStart)+i+ed.value.substring(ed.selectionStart,j);}ed.onblur();};var H=$ce("div","<a href='javascript:void(0);' onclick='cur.addLabel();' class='link-U666'>插入标签</a>&nbsp;&nbsp;"+a7,bw);H.style.marginBottom="8px";if(ar){var dk=control_check();dk.onclick=function(){if(!vipUser){alert("只有企业版用户才能设置行标题随机，请升级！");this.checked=false;return;}cz.dataNode._randomRow=this.checked;};dk.checked=cz.dataNode._randomRow;var X=document.createElement("span");X.innerHTML="行标题随机&nbsp;&nbsp;";X.title="标题随机显示";H.appendChild(dk);H.appendChild(X);}if(bZ){var df="<a href='javascript:void(0);' class='link-444' onclick='cur.changeRowColumnTitle();'>交换行列标题</a>";$ce("span",df,H);this.changeRowColumnTitle=function(){var i=this.dataNode._rowtitle;this.dataNode._rowtitle=this.dataNode._columntitle;this.dataNode._columntitle=i;ed.value=this.dataNode._rowtitle;aQ.value=cur.dataNode._columntitle;this.updateItem();};}bw.appendChild(T);bw.appendChild(d5);if(ar){var dW=document.createElement("div");dW.style.margin="8px 0 5px";$ce("span","最小值：",dW);var cs=control_text("3");cs.title="用户可以选择的最小值";cs.maxLength=3;cs.value=this.dataNode._minvalue;dW.appendChild(cs);cs.onchange=cs.onblur=function(){var i=this.value;if(!isEmpty(this.value)||cz.dataNode._tag=="202"){if(!isInt(this.value)||this.value-ao.value>0){show_status_tip("最小值不合法",4000);i=(0-ao.value<0)?0:toInt(ao.value)-1;if(parseInt(i)!=i){i=0;}}else{i=toInt(this.value);}}this.value=cz.dataNode._minvalue=i;cz.updateItem();if(cz.updateSpanCheck){cz.updateSpanCheck();}};$ce("span","最大值：",dW).style.marginLeft="60px";var ao=control_text("3");ao.title="用户可以选择的最大值";ao.maxLength=3;if(this.dataNode._tag=="301"){cs.maxLength=ao.maxLength=12;cs.style.width=ao.style.width="80px";}ao.value=this.dataNode._maxvalue;dW.appendChild(ao);dW.style.display=(this.dataNode._tag=="202"||this.dataNode._tag=="301")?"":"none";ao.onchange=ao.onblur=function(){var i=this.value;if(!isEmpty(this.value)||cz.dataNode._tag=="202"){if(!isInt(this.value)||this.value-cs.value<0){show_status_tip("最大值不合法",4000);i=(10-cs.value>0)?10:toInt(cs.value)+1;if(parseInt(i)!=i){i=10;}}else{i=toInt(this.value);}}this.value=cz.dataNode._maxvalue=i;cz.updateItem();if(cz.updateSpanCheck){cz.updateSpanCheck();}};bw.appendChild(dW);}}if(dT){$ce("div","",db).style.paddingTop="10px";var dX=document.createElement("div");dX.style.margin="5px 0";if(M||cR){dX.style.display="none";}var dd=$ce("div","",dX);if(az||aW){var bS=document.createElement("span");bS.className="spanRight";dd.appendChild(bS);var bt="<ul class='likertImageTypeList' style='display:inline;margin:0;' ><li>&nbsp;&nbsp;<b>样式：</b></li>";if(ar){bt+="<li class='design-icon design-offr' onclick='cur.set_likertMode(101);'></li>";}else{bt+="<li style='font-size:16px;'><a style='height:24px;line-height:24px;display:inline-block;' href='javascript:cur.set_likertMode(1);'><b>123</b></a></li> <li class='design-icon design-offr' onclick='cur.set_likertMode(101);'></li>";}var bB="";bt+="<li style='background:url(/images/wjx/JoinQuestionnaire/Rate/jianbian.png) no-repeat;width:24px;height:24px;' onclick='cur.set_likertMode(6);' style='"+bB+"'></li>";bt+="<li class='design-icon design-on2' onclick='cur.set_likertMode(2);' style='"+bB+"'></li>";bt+="<li  class='design-icon design-on3' onclick='cur.set_likertMode(3);'  style='"+bB+"'></li>";bt+="<li  class='design-icon design-on4' onclick='cur.set_likertMode(4);' style='"+bB+"'></li>";bt+="<li style='clear:both;'></li>";bt+="</ul>";bS.innerHTML=bt;this.set_likertMode=function(i){var j=this.dataNode._tag<102;this.dataNode._tag=i;this.createTableRadio(true);if(this.dataNode._type=="matrix"){dX.style.display=i>200?"none":"";b3.style.display=dX.style.display;if(j&&i>101){P.disabled=false;P.checked=false;P.onclick();this.dataNode._hasvalue=false;}else{if(!j&&i<102){P.checked=true;P.onclick();P.disabled=true;this.dataNode._hasvalue=true;}}P.disabled=i>101?false:true;if(!isMergeAnswer||this.isMergeNewAdded){cF.style.display=i>101?"none":"";}if(i==202){dW.style.display="";this.dataNode._minvalue=this.dataNode._minvalue||0;this.dataNode._maxvalue=this.dataNode._maxvalue||10;this.dataNode._rowwidth=this.dataNode._rowwidth||100;rowwidth_text.value=rowwidth_text.value||100;}else{dW.style.display="none";}}};if(isMergeAnswer&&!this.isMergeNewAdded&&this.dataNode._tag>101){bS.style.display="none";}}if(((aW)||ar)&&(!isMergeAnswer||this.isMergeNewAdded)){var cF=$ce("span","",dd);cF.className="spanRight";var cC=document.createElement("span");var b7="<select onchange='cur.set_likert_num(this);'>";var p=m._select.length-1;for(var dF=2;dF<=10;dF++){var b6="";if(dF==p){b6=" selected='selected' ";}b7+="<option"+b6+" value='"+dF+"'>"+dF+"级量表</option>";}b7+="</select>";cC.innerHTML+=b7;this.set_likert_num=function(dw){var eh=dw.value;var j=cY.length-1;for(var i=0;i<eh;i++){cY[j+i].get_item_add().onclick();cY[j+i+1].get_item_title().value=i+1;cY[j+i+1].get_item_value().value=i+1;}for(var i=1;i<j+1;i++){cY[1].get_item_del().onclick();}if(!az){cY[1].get_item_title().value="非常不满意";cY[cY.length-1].get_item_title().value="非常满意";}cY[1].get_item_title().onchange();this.popHint("");window.focus();};cF.appendChild(cC);if(ar&&this.dataNode._tag>101){cF.style.display="none";}}if(ar){cp.style.background="#D5E2F2";}if(cw=="radio"||cw=="check"){if(cV){cp.style.width="75%";}else{if(bQ){cp.style.width="66%";}else{if(M){cp.style.width="62%";}else{if(cR){cp.style.width="70%";}else{if(eb){if(cw=="radio"){cp.style.width="100%";}else{cp.style.width="82%";}}}}}}}else{if(cw=="matrix"){if(cV=="201"||cV=="202"||cV=="301"||cV=="302"){cp.style.width="400px";}if(cV=="301"||cV=="302"){cp.style.width="500px";}}else{cp.style.width="75%";}}if(!ar){dX.appendChild(T);dX.appendChild(d5);}this.setNotNewAdd=function(){if(!cz.newAddQ){return;}c0.style.display="";cz.newAddQ=false;b3.style.display="";};this.addNewItem=function(){var i=cY.length;cY[i-1].get_item_add().onclick();};if(bE){var ax=$ce("div","<span style='color:#333; font-weight:bold;'>投票设置：</span>",dX);ax.style.marginTop="10px";var dA=$ce("span","&nbsp;&nbsp;",ax);var by=control_check();dA.appendChild(by);dA.appendChild(document.createTextNode("选项说明点击后弹出"));var g=control_check();dA.appendChild(g);dA.appendChild(document.createTextNode("显示投票数"));var dn=control_check();dA.appendChild(dn);dA.appendChild(document.createTextNode("显示百分比"));by.checked=by.defaultChecked=m._displayDesc;g.checked=g.defaultChecked=m._displayNum;dn.checked=dn.defaultChecked=m._displayPercent;by.onclick=function(){var eh=false;var dw=cz.dataNode._select;for(var j=1;j<dw.length;j++){if(dw[j]._item_desc){eh=true;}}if(!eh&&this.checked){alert("提示：您的投票选项没有添加说明，不能应用此设置！");this.checked=false;return;}cz.dataNode._displayDesc=this.checked;cz.createTableRadio(true);};dn.onclick=function(){cz.dataNode._displayPercent=this.checked;cz.createTableRadio(true);};g.onclick=function(){cz.dataNode._displayNum=this.checked;cz.createTableRadio(true);};var O=$ce("span","选项宽度：",ax);O.style.marginLeft="15px";var dJ="<select onchange='cur.setTWidth(this);'><option value='20'>20%</option><option value='30'>30%</option><option value='40'>40%</option><option value='50'>50%</option><option value='60'>60%</option><option value='70'>70%</option><option value='自定义'>自定义</option></select>&nbsp;";O.innerHTML+=dJ;var r=$ce("span","",O);var b4=control_text("3");b4.maxLength=2;b4.onchange=b4.onblur=function(){var i=this.value;if(!isEmpty(i)&&!isInt(i)){show_status_tip("您输入的宽度不合法！");this.value="";cz.dataNode._touPiaoWidth=50;}else{cz.dataNode._touPiaoWidth=i?parseInt(i):"";}cz.createTableRadio(true);};this.setTWidth=function(i){if(i.value!="自定义"){b4.value=i.value;r.style.display="none";b4.onchange();}else{r.style.display="";}};this.initWidth=function(){if(this.dataNode._touPiaoWidth){b4.value=this.dataNode._touPiaoWidth;var eh=$$("select",O)[0];eh.value=this.dataNode._touPiaoWidth;var j=true;for(var dw=0;dw<eh.options.length;dw++){if(eh.options[dw].value==this.dataNode._touPiaoWidth){j=false;break;}}if(j){eh.value="自定义";this.setTWidth(eh);}}};r.appendChild(b4);r.appendChild(document.createTextNode("%"));r.style.display="none";ax.appendChild(O);this.initWidth();}else{if(bQ){this.addCeShiSetting(dX);}}var b3=$ce("div","",cp);var aV=document.createElement("table");aV.className="tableoption";aV.style.backgroundColor="#D5E2F2";aV.cellSpacing="3";aV.cellPadding="3";aV.width="94%";var cr=aV.insertRow(-1);cY[0]=cr;var bc=!m._tag&&!eb&&(m._type=="check"||m._type=="radio"||m._type=="radio_down");var D=cr.insertCell(-1);D.style.width="150px";if(ar&&cV&&cV<=101){D.style.width="100px";}if(ar&&cV=="303"){D.style.width="120px";}var dD=$ce("span","",D);if(cR){dD.innerHTML="商品名称";}else{var dP=$ce("a","选项文字<img src='http://image.sojump.com/images/WJX/ViewStat/arrownone.gif' alt=''>",dD);dP.title="交换选项文字";dP.style.fontWeight="bold";dP.style.color="#333333";dP.style.fontSize="14px";dP.style.textDecoration="none";dP.href="javascript:void(0);";dP.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded){show_status_tip("合并答卷模式不能交换选项文字",4000);return false;}var ei=false;var j=false;if(aW||az||eb||cV==303){j=true;}if(j&&confirm("是否同时交换选项分数？")){ei=true;}var eh=1;var i=cY.length-1;while(eh<i){var dw=cY[i].get_item_title().value;cY[i].get_item_title().value=cY[eh].get_item_title().value;cY[eh].get_item_title().value=dw;if(ei){dw=cY[i].get_item_value().value;cY[i].get_item_value().value=cY[eh].get_item_value().value;cY[eh].get_item_value().value=dw;if(cY[i].get_item_novalue()){dw=cY[i].get_item_novalue().checked;cY[i].get_item_novalue().checked=cY[eh].get_item_novalue().checked;cY[eh].get_item_novalue().checked=dw;}}eh++;i--;}cur.updateItem();return false;};}if(eb||(bc&&m._type!="radio_down"&&!M)){var an=cr.insertCell(-1);var d0="图片";imgwidth="27px";if(cR){d0="商品图片";imgwidth="50px";}$ce("span",d0,an);an.style.width=imgwidth;}if(eb||(bc&&m._type!="radio_down"&&!cR)){var c5=cr.insertCell(-1);var bK="说明";var di="27px";if(M){bK="情景说明";di="50px";}$ce("span",bK,c5);c5.style.width=di;}if((bc&&m._type!="radio_down")||(ar&&(cV=="102"||cV=="103"||cV=="101"))||eb){var dj=cr.insertCell(-1);var al=$ce("span","<b>可填空</b>",dj);dj.style.width="70px";if(bQ||M||cR){dj.style.display="none";}}var aw=cr.insertCell(-1);if(!bQ&&!bZ&&!M){aw.style.width="90px";}if(cR){aw.style.width="50px";}var bv=$ce("span","",aw);var P=control_check();P.title="给选项设置分数，可用于Likert量表或者测试类型的问卷";bv.appendChild(P);var dc=$ce("span","",bv);dc.innerHTML="&nbsp;<b>分数</b><span class='bordCss bordBottomCss' style='border-color:#2E6AB1 transparent transparent;'></span>";dc.style.cursor="pointer";if(M){dc.innerHTML="数量";}else{if(cR){dc.innerHTML="商品价格";}}if(aW||az||eb||cV==303){P.style.display="none";bv.onmouseover=function(){openValWindow(cz,this);};bv.onmouseout=function(){sb_setmenunav(toolTipLayer,false);};}else{if(!M&&!cR){aw.style.display="none";}else{P.style.display="none";}}P.onclick=function(){if(cz.dataNode._isCeShi){return;}if(this.checked){for(var i=1;i<cY.length;i++){cY[i].get_item_value().parentNode.style.display="";}}else{for(var i=1;i<cY.length;i++){cY[i].get_item_value().parentNode.style.display="none";}}cz.dataNode._hasvalue=this.checked;};var bH=cr.insertCell(-1);if(cw=="radio"||cw=="radio_down"){if(!bQ&&!M){bH.style.width="80px";}var aZ=$ce("span","&nbsp;",bH);if(bQ||M){aZ.style.display="none";}var cZ=control_check();var bg=$ce("span","跳题",aZ);var aN=$ce("a","<b>(?)</b>",bg);aN.href="javascript:void(0);";aN.style.color="green";aN.onmouseover=function(){toolTipLayer.style.width="250px";toolTipLayer.innerHTML="按选项跳题，允许用户填写此题时根据选中的选项跳到后面指定的题号。<a target='_blank' class='link-U00a6e6' href='/help/help.aspx?helpid=218&h=1'>查看示例</a>";sb_setmenunav(toolTipLayer,true,this);};aN.onmouseout=function(){sb_setmenunav(toolTipLayer,false,this);};aZ.appendChild(cZ);aZ.appendChild(bg);cZ.onclick=function(){if(this.checked){cz.dataNode._anytimejumpto="";bD.value="";if(bT.checked){bT.click();}for(var i=1;i<cY.length;i++){cY[i].get_item_jump().parentNode.style.display="";}}else{for(var i=1;i<cY.length;i++){cY[i].get_item_jump().parentNode.style.display="none";}}if(cz.defaultCheckSet){cz.defaultCheckSet();}cz.dataNode._hasjump=this.checked;cz.set_jump_ins();cz.updateItem();};}else{if(cR){bH.innerHTML="总库存";bH.style.width="80px";}}if(cw=="check"&&!bQ&&!dQ&&!eb&&!cR){var bG=cr.insertCell(-1);var K=$ce("span","&nbsp;",bG);var bO=$ce("span","选项互斥",K);bO.title="与其它选项互斥";K.appendChild(bO);}if(cw=="matrix"){bH.style.display="none";}var ci=cr.insertCell(-1);if(bc&&!M&&!cR){var bl=$ce("span","&nbsp;",ci);var b0=$ce("span","",bl);b0.innerHTML="默认";if(bQ){b0.innerHTML="正确答案";}this.defaultCheckSet=function(){if(this.dataNode._isCeShi){return;}var j=bT.checked||(cZ?cZ.checked:false);for(var i=1;i<cY.length;i++){var dw=cY[i].get_item_check();dw.parentNode.style.display=j?"none":"";if(j){dw.checked=false;}}};}else{ci.style.display="none";}if(bc&&m._type!="radio_down"){var b2=cr.insertCell(-1);$ce("span","分组<a href='/help/help.aspx?helpid=149' target='_blank' style='color:green;'><b>(?)</b></a>",b2);if(bQ||M||cR){b2.style.display="none";}}var a1=cr.insertCell(-1);a1.align="center";a1.style.width="90px";$ce("span","操作",a1);if(bn){for(var dE=1;dE<m._select.length;dE++){cY[dE]=new creat_item(cz,dE,aV,"check",false,m._select[dE]);}}else{for(var dE=1;dE<m._select.length;dE++){cY[dE]=new creat_item(cz,dE,aV,"radio",false,m._select[dE]);}}this.checkItemTitle=function(){var i=true;if(!this.checkEmptyItem()){return false;}if(!this.checkRepeatItem()){return false;}this.isItemTitleValid=true;return true;};this.checkEmptyItem=function(){var eh=true;for(var j=1;j<cY.length;j++){var dw=cY[j].get_item_title();if(trim(dw.value)==""){if(dw.initText){dw.value=dw.initText;}else{this.popHint("选项不能为空！");eh=false;this.isItemTitleValid=false;}}}return eh;};this.checkRepeatItem=function(){var ek=true;for(var ei=1;ei<cY.length;ei++){var eh=cY[ei].get_item_title();if(eh._oldBorder||eh._oldBorder==""){eh.style.border=eh._oldBorder;eh.title=eh._oldTitle;}for(var dw=ei+1;dw<cY.length;dw++){if(trim(cY[ei].get_item_title().value)==trim(cY[dw].get_item_title().value)){var ej=cY[dw].get_item_title();eh.rel=ej;ej.rel=eh;this.popHint("第"+ei+"个选项与第"+dw+"个选项重复，请修改！");ek=false;this.isItemTitleValid=false;return false;}}}return ek;};this.checkItemValue=function(){var eh=true;if(P.checked){for(var dw=1;dw<cY.length;dw++){var j=trim(cY[dw].get_item_value().value);if(j==""){if(!cY[dw].get_item_novalue()||!cY[dw].get_item_novalue().checked){cY[dw].get_item_value().value=0;}}else{if(!isInt(j)){this.popHint("选项的分数不合法，请修改！");eh=false;}}}}this.isItemValueValid=eh;return eh;};this.checkItemJump=function(dw){var ej=true;if(cZ&&cZ.checked){var ei;for(var j=1;j<cY.length;j++){ei=trim(cY[j].get_item_jump().value);if(ei!=""&&ei!=0&&ei!=1){var eh="";if(!isPositive(ei)){eh="选项的跳转题号必须是正整数";}else{if(toInt(ei)<=this.dataNode._topic){eh="跳转题号必须大于本题题号("+this.dataNode._topic+")";}else{if(toInt(ei)>total_question){eh="跳转题号必须小于或等于最大题号("+total_question+")";}}}if(eh){this.popHint(eh);ej=false;}}}}if(!dw){this.isItemJumpValid=ej;}else{this.isItemJumpValid=false;}return ej;};this.checkCeShiSet=function(){if(!this.dataNode._isCeShi){return true;}var j=false;for(var i=1;i<m._select.length;i++){if(m._select[i]._item_radio){j=true;}}if(!j){this.popHint("请设置此题的正确答案");}this.isCeShiValid=j;return j;};this.setItemJump=function(){for(var j=1;j<cY.length;j++){cY[j].get_item_jump().value=this.dataNode._select[j]._item_jump;}};b3.appendChild(aV);db.appendChild(cp);$ce("div","",db).className="divclear";var cx=$ce("span","",dd);dd.style.width="94%";if(bQ){dd.style.width="63%";}else{if(aW){dd.style.width="71%";}else{if(dQ){dd.style.width="72%";}else{if(cT){dd.style.width="72%";}else{if(bn&&eb){dd.style.width="80%";}}}}}cx.className="spanLeft";if(cT||dQ||bQ||eb||bE||(isMergeAnswer&&!this.isMergeNewAdded)||ar||!dU){a7="";}var ah="<a href='javascript:cur.addNewItem();' class='titlelnk' style='text-decoration:none;'><span class='choiceimg design-icon design-add' ></span><b>添加选项</b></a>&nbsp;&nbsp;";var dO="<a href='javascript:PDF_launch(\"oftenoptions.aspx\",540,400);' class='batchadd'><span class='choiceimg design-icon design-badd'></span><b>批量增加</b></a>&nbsp;";var q="";cx.innerHTML=ah+dO+"&nbsp;"+a7;if(aW){cx.innerHTML=ah+dO;}else{if(ar&&(this.dataNode._tag&&this.dataNode._tag<=101||this.dataNode._tag==102)){cx.innerHTML=dO;}}if(isMergeAnswer&&!this.isMergeNewAdded){cx.innerHTML=ah;}var cL=$ce("span","",dd);if((aI&&cV==0)||(bn&&!dQ)){var d9=null;var y=document.createElement("span");var av="";var c4=1;if(aI&&!eb&&!bQ&&!bE){av="<option value='0'>下拉菜单</option>";c4=2;}y.innerHTML="<select onchange='cur.checkNumPer(this);' style='width:90px;'><option value='1'>竖向排列</option>"+av+"<optgroup label='横向排列'><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='11'>11</option><option value='12'>12</option><option value='15'>15</option><option value='20'>20</option><option value='30'>30</option></optgroup></select>&nbsp;";d9=$$("select",y)[0];for(var dF=c4;dF<d9.options.length;dF++){d9.options[dF].text="每行"+d9.options[dF].value+"列";}cL.appendChild(y);if(dQ&&d9){y.style.display="none";}this.checkNumPer=function(dw){var i=trim(dw.value);if(i==0){this.selChangeType("radio_down");return;}this.dataNode._numperrow=parseInt(i);this.createTableRadio(true);this.focus();if(!this.applyNumber){var j=$ce("span","&nbsp;&nbsp;<a href='javascript:void(0);' class='link-U00a6e6' title='批量复制此属性到后面的题目'>批量复制</a>",cL);j.onclick=function(){var eh="/wjx/design/applynumrow.aspx";var ei=cz.dataNode._topic;eh+="?ct="+ei;PDF_launch(eh,500,250,null,"批量复制选项排列属性到后面的题目");};this.applyNumber=true;}};y.style.display="inline-block";}cL.className="spanRight";var Q=$ce("span","",dd);var b5=control_check();Q.appendChild(b5);$ce("span","选项随机&nbsp;",Q);Q.className="spanRight";if(bQ){var a=$ce("span","<a class='titlelnk' onclick='setAllRandom();' href='javascript:' title='复制随机属性到其它的考试题'>复制到其它考试题</a>&nbsp;",Q);a.style.display="none";this.get_random=function(){return b5;};}b5.onclick=function(){cz.dataNode._randomChoice=this.checked;if(bQ){a.style.display="";}};if(aW||ar){Q.style.display="none";}if((bn&&!bQ)||(ar&&cV=="102")){var bf=null;bf=$ce("span","",dd);var at="至少选";if(ar){at="&nbsp;&nbsp;"+at;}$ce("span",at,bf);bf.className="spanRight";var c9=document.createElement("span");var aK="<select onchange='cur.limitChange(this);' onclick='cur.lowLimitClick(this);' style='width:44px;'>";aK+="<option value=''> </option>";for(var dF=1;dF<m._select.length;dF++){aK+="<option value='"+dF+"'>"+dF+"</option>";}aK+="</select>";c9.innerHTML=aK;var a5=document.createElement("span");a5.innerHTML="项&nbsp;最多选";var aO=document.createElement("span");var Y="<select onchange='cur.limitChange(this);' onclick='cur.upLimitClick(this);' style='width:44px;'>";Y+="<option value=''> </option>";for(var dF=2;dF<m._select.length;dF++){Y+="<option value='"+dF+"'>"+dF+"</option>";}Y+="</select>";aO.innerHTML=Y;var dz=document.createTextNode("项");bf.appendChild(c9);bf.appendChild(a5);bf.appendChild(aO);bf.appendChild(dz);this.limitChange=function(){cz.checkCheckLimit();window.focus();};this.lowLimitClick=function(eh){if(m._select.length-1==eh.options.length-1){return;}eh.options.length=0;eh.options.add(new Option(" ",""));for(var dw=1;dw<m._select.length;dw++){var j=new Option(dw,dw);eh.options.add(j);}};this.upLimitClick=function(eh){if(m._select.length-1==eh.options.length){return;}eh.options.length=0;eh.options.add(new Option(" ",""));for(var dw=2;dw<m._select.length;dw++){var j=new Option(dw,dw);eh.options.add(j);}};var dM=m._lowLimit;var d4=m._upLimit;if(dQ){if(!m._lowLimit){dM=m._lowLimit=m._select.length-1;}if(!m._upLimit){d4=m._upLimit=m._select.length-1;}if(m._lowLimit==-1){dM="";}if(m._upLimit==-1){d4="";}}$$("select",c9)[0].value=dM||"";$$("select",aO)[0].value=d4||"";$ce("span","&nbsp;&nbsp;",bf);this.checkCheckLimit=function(){if(bn||(ar&&cV=="102")){var j=$$("select",c9)[0].value;var dw=$$("select",aO)[0].value;var i=cY.length-1;if(j!=""){if(dw!=""&&dw-j<0){j=dw;$$("select",c9)[0].value=dw;show_status_tip("要求用户最多选中选项数量不合法！",4000);}if(!l.checked){show_status_tip("由于设置了选项数量限制，建议将该题设为必答",4000);}}else{if(dQ){j=-1;}}if(dw!=""){if(j!=""&&dw-j<0){dw=j;$$("select",aO)[0].value=j;show_status_tip("要求用户最多选中选项数量不合法！",4000);}}else{if(dQ){dw=-1;}}this.dataNode._lowLimit=j;this.dataNode._upLimit=dw;this.updateSpanCheck();}return true;};}$ce("div","",dd).className="divclear";if(ar){b3.appendChild(dX);}else{db.appendChild(dX);}this.initFreOptions=function(ei){var eh="";var dw=/^选项\d+$/;var j=0;for(var i=1;i<cY.length;i++){var ej=trim(cY[i].get_item_title().value);if(!ej){continue;}if(dw.test(ej)){continue;}if(j>0){eh+="\n";}eh+=ej;j++;}if(eh){ei.value=eh+"\n";}};this.setFreOptions=function(ei){var ej=ei.split("\n");if(ei=="每行一个选项，可以添加多个选项"){return;}var ek=new Array();for(var eh=0;eh<ej.length;eh++){if(ej[eh]&&trim(ej[eh])){ek.push(ej[eh]);}}for(var eh=ek.length;eh<2;eh++){ek[eh]="选项"+(eh+1);}for(var j=0;j<ek.length;j++){if(cY[j+1]){cY[j+1].get_item_title().value=trim(ek[j]);continue;}if(bn){cY[j+1]=new creat_item(this,j+1,aV,"check",false,null);}else{cY[j+1]=new creat_item(this,j+1,aV,"radio",false,null);}cY[j+1].get_item_title().value=trim(ek[j]);cY[j+1].get_item_value().value=j+1;}var dw=cY.length-1;for(var j=dw;j>ek.length;j--){aV.deleteRow(j);cY.length=cY.length-1;}this.updateItem();this.setNotNewAdd();setQTopPos(this);};this.checkTextJump=function(dw){if((aI||cT)&&!cZ.checked&&!hasInsPromoteJump){var j=/[一二三四五六七八九\d]+题/;var i=j.exec(dw);if(i){hasInsPromoteJump=true;if(window.confirm("您是否需要按选项设置此题的跳题逻辑？")){cZ.click();}}}};this.updateItem=function(el){var ei=true;if(this.dataNode._type!="matrix"){this.popHint("");}if(!this.checkItemTitle()){ei=false;}if(!this.checkItemValue()){ei=false;}if(!this.checkItemJump(true)){ei=false;}if(!ei){return;}var ek=this.dataNode;ek._select=new Array();var eh=!ek._tag&&(ek._type=="check"||ek._type=="radio"||ek._type=="radio_down");for(var dw=1;dw<cY.length;dw++){ek._select[dw]=new Object();var ej=cY[dw].get_item_title();var i=replace_specialChar(trim(ej.value));if(i!=ej.value){ej.value=i;}ek._select[dw]._item_title=ej.value.replace(/\</g,"&lt;");ek._select[dw]._item_radio=false;if(eh||ek._isCeShi){ek._select[dw]._item_radio=cY[dw].get_item_check().checked;}ek._select[dw]._item_value=trim(cY[dw].get_item_value().value);ek._select[dw]._item_jump=0;if(aI||cT||cR){ek._select[dw]._item_jump=trim(cY[dw].get_item_jump().value);}if(cY[dw].get_item_huchi()){ek._select[dw]._item_huchi=cY[dw].get_item_huchi().checked;}ek._select[dw]._item_tb=false;ek._select[dw]._item_tbr=false;ek._select[dw]._item_img="";ek._select[dw]._item_imgtext=false;ek._select[dw]._item_desc="";ek._select[dw]._item_label="";if(cY[dw].get_item_tb()){ek._select[dw]._item_tb=cY[dw].get_item_tb().checked;}if(cY[dw].get_item_tbr()){ek._select[dw]._item_tbr=cY[dw].get_item_tbr().checked;}if(cY[dw].get_item_img()){ek._select[dw]._item_img=cY[dw].get_item_img().value=replace_specialChar(trim(cY[dw].get_item_img().value));}if(cY[dw].get_item_imgtext()){ek._select[dw]._item_imgtext=cY[dw].get_item_imgtext().checked;}if(cY[dw].get_item_desc()){ek._select[dw]._item_desc=cY[dw].get_item_desc().value=replace_specialChar(trim(cY[dw].get_item_desc().value));}if(cY[dw].get_item_label()){ek._select[dw]._item_label=cY[dw].get_item_label().value=replace_specialChar(trim(cY[dw].get_item_label().value));}}if(!this.checkCeShiSet()){return;}if(!el){this.createTableRadio(true);}};}if(ar||u){var aE=$ce("div","",db);aE.style.marginTop="15px";if(ar){var C=$ce("span","<b>题目总宽度：</b>",aE);var dJ="<select onchange='cur.setMainWidth(this);'><option value=''>默认</option><option value='50'>50%</option><option value='60'>60%</option><option value='70'>70%</option><option value='80'>80%</option><option value='90'>90%</option><option value='100'>100%</option><option value='自定义'>自定义</option></select>&nbsp;";C.innerHTML+=dJ;var aP=$ce("span","",C);var a3=control_text("3");a3.maxLength=2;a3.onchange=a3.onblur=function(){var i=this.value;if(!isEmpty(i)&&!isInt(i)){show_status_tip("您输入的宽度不合法！");this.value="";cz.dataNode._mainWidth=50;}else{cz.dataNode._mainWidth=i?parseInt(i):"";}cz.createTableRadio(true);};this.setMainWidth=function(i){if(i.value!="自定义"){a3.value=i.value;aP.style.display="none";a3.onchange();}else{aP.style.display="";}};this.initMainWidth=function(){if(this.dataNode._mainWidth){a3.value=this.dataNode._mainWidth;var eh=$$("select",C)[0];eh.value=this.dataNode._mainWidth;var j=true;for(var dw=0;dw<eh.options.length;dw++){if(eh.options[dw].value==this.dataNode._mainWidth){j=false;break;}}if(j){eh.value="自定义";this.setMainWidth(eh);}}};aP.appendChild(a3);aP.appendChild(document.createTextNode("%"));aP.style.display="none";if(cV=="102"){C.style.display="none";}}var dt="左行标题宽度：";if(u){dt="行标题宽度：";}var cu=$ce("span","&nbsp;&nbsp;<b>"+dt+"</b>",aE);var cJ="<select onchange='cur.setTWidth(this);'><option value=''>默认</option><option value='10%'>10%</option><option value='15%'>15%</option><option value='20%'>20%</option><option value='30%'>30%</option><option value='40%'>40%</option><option value='50%'>50%</option><option value='自定义'>自定义</option></select>&nbsp;";cu.innerHTML+=cJ;var aT=control_text("3");aT.maxLength=3;aT.onchange=aT.onblur=function(){var i=this.value;if(!isEmpty(i)&&(!isInt(i)||i-100>0)){show_status_tip("您输入的宽度不合法！");this.value="";cz.dataNode._rowwidth="";}else{cz.dataNode._rowwidth=i+"%";if(cz.dataNode._rowwidth=="%"){cz.dataNode._rowwidth="";}}if(u){cz.createSum();}else{if(ar){cz.updateItem();}}window.focus();};this.setTWidth=function(i){if(i.value!="自定义"){aT.value=i.value.replace("%","");aT.style.display="none";aT.onchange();}else{aT.style.display="";}};this.initWidth=function(){if(this.dataNode._rowwidth&&this.dataNode._rowwidth.indexOf("%")>-1){var i=$$("select",cu)[0];i.value=this.dataNode._rowwidth;aT.value=this.dataNode._rowwidth.replace("%","");if(i.selectedIndex==-1){i.value="自定义";this.setTWidth(i);}}};aT.style.display="none";cu.appendChild(aT);if(ar){var aJ=$ce("span","<b>右行标题宽度：</b>",aE);aJ.style.display="none";var bW="<select onchange='cur.setTWidth2(this);'><option value=''>默认</option><option value='10%'>10%</option><option value='15%'>15%</option><option value='20%'>20%</option><option value='30%'>30%</option><option value='40%'>40%</option><option value='50%'>50%</option><option value='自定义'>自定义</option></select>&nbsp;";aJ.innerHTML+=bW;var dH=control_text("3");dH.maxLength=3;dH.onchange=dH.onblur=function(){var i=this.value;if(!isEmpty(i)&&(!isInt(i)||i-100>0)){show_status_tip("您输入的宽度不合法！");this.value="";cz.dataNode._rowwidth2="";}else{cz.dataNode._rowwidth2=i+"%";if(cz.dataNode._rowwidth2=="%"){cz.dataNode._rowwidth2="";}}cz.updateItem();window.focus();};this.setTWidth2=function(i){if(i.value!="自定义"){dH.value=i.value.replace("%","");dH.style.display="none";dH.onchange();}else{dH.style.display="";}};this.initWidth2=function(){if(this.dataNode._rowwidth2&&this.dataNode._rowwidth2.indexOf("%")>-1){var i=$$("select",aJ)[0];i.value=this.dataNode._rowwidth2;dH.value=this.dataNode._rowwidth2.replace("%","");if(i.selectedIndex==-1){i.value="自定义";this.setTWidth2(i);}}};dH.style.display="none";aJ.appendChild(dH);}if(ar&&(this.dataNode._tag==102||this.dataNode._tag==103)){var cE=control_check();aE.appendChild(cE);var h=$ce("span","竖向选择<a title='当选项太多时，通过竖向选择可以得到更好的显示效果' href='javascript:void(0);' style='color:green;'><b>(?)</b></a>",aE);cE.onclick=function(){if(cz._referDivQ){show_status_tip("使用引用逻辑后，不能再使用竖向选择",5000);return;}cz.dataNode._daoZhi=this.checked;cz.updateSpanMatrix();cz.updateItem();};$ce("span","&nbsp;&nbsp;",aE);var v=$ce("a","交换选项与行",aE);v.className="link-666";var bR=$ce("span","<a title='如果您将行与选项正好相反，可以“交换选项与行”。' href='javascript:void(0);' style='color:green;'><b>(?)</b></a>",aE);v.href="javascript:void(0);";v.onclick=function(){if(isMergeAnswer&&!cz.isMergeNewAdded){show_status_tip("在合并答卷模式下，不能“交换选项与行”",5000);return;}if(window.confirm("确定交换行与选项吗？")){var j="";var eh=cz.dataNode._select;for(var i=1;i<eh.length;i++){if(i>1){j+="\n";}j+=eh[i]._item_title;}var dw=ed.value;if(dw){ed.value=j;cz.checkRowTitle();cz.setFreOptions(dw);}}};}}if(ar){b3.style.width="310px";if(cV=="102"||cV=="103"){b3.style.width="350px";}if(cV&&cV<=101){b3.style.width="390px";}if(cV=="303"){b3.style.width="295px";}b3.style.paddingTop="5px";aV.cellSpacing="0";aV.cellPadding="2";aV.width="98%";setFloat(b3);setFloat(bw);$ce("div","",cp).style.clear="both";if(cV=="201"){var dC=document.createElement("div");var c7=document.createElement("span");dC.appendChild(c7);this.refreshSelRow=function(){var el=this.dataNode;var ei=trim(el._rowtitle).split("\n");var ek="";var ej=0;for(var eh=0;eh<ei.length;eh++){if(ei[eh].substring(0,4)=="【标签】"){continue;}var dw="<option value='"+ej+"'>第"+(ej+1)+"行:"+ei[eh]+"</option>";ej++;ek+=dw;}c7.innerHTML="<b>行属性</b>：<select style='width:200px;'><option value='-1'>请选择行</option>"+ek+"</select>&nbsp;";var j=$$("select",c7)[0];j.onchange=function(){var en=this.value;var em=parseInt(en);cN.style.display=em<0?"none":"";var i=$$("select",cN)[0];if(!cz.dataNode._rowVerify||!cz.dataNode._rowVerify[em]){i.value="0";au.value="";d8.value="";be.value="";return;}i.value=cz.dataNode._rowVerify[em]._verify||"0";au.value=cz.dataNode._rowVerify[em]._minword||"";d8.value=cz.dataNode._rowVerify[em]._maxword||"";be.value=cz.dataNode._rowVerify[em]._width||"";};};this.refreshSelRow();dC.style.margin="10px 0 0 15px";aB.appendChild(dC);var cN=document.createElement("span");cN.style.display="none";var aD=getVerifyHtml();cN.innerHTML=aD;dC.appendChild(cN);this.setVerify=function(dw){if(!this.dataNode._rowVerify){this.dataNode._rowVerify=new Array();}var i=$$("select",c7)[0];var ei=i.value;var eh=parseInt(ei);if(!cz.dataNode._rowVerify[eh]){cz.dataNode._rowVerify[eh]=new Object();}var j=this.dataNode._rowVerify[eh]._verify;this.dataNode._rowVerify[eh]._verify=dw.value;if(dw.value=="数字"||dw.value=="小数"){aC.innerHTML=aC.innerHTML.replace("字数","值");aj.innerHTML=aj.innerHTML.replace("字数","值");ag="值";}else{aC.innerHTML=aC.innerHTML.replace("值","字数");aj.innerHTML=aj.innerHTML.replace("值","字数");ag="字数";}this.updateItem();};this.initVerify=function(){var j=this.dataNode._verify||"0";var i=$$("select",cN)[0];i.value=j;};var z=$ce("span","&nbsp;宽度：",cN);var cS="<select onchange='cur.setMatrixItemWidth(this);'><option value=''>默认</option>";for(var dF=1;dF<9;dF++){var co=dF*10;cS+="<option value='"+co+"'>"+co+"%</option>";}cS+="</select>";var a4=$ce("span",cS,cN);var be=$$("select",a4)[0];this.setMatrixItemWidth=function(j){if(!cz.dataNode._rowVerify){cz.dataNode._rowVerify=new Array();}var i=$$("select",c7)[0];var eh=i.value;var dw=parseInt(eh);if(dw==-1){alert("请选择行");return;}if(!cz.dataNode._rowVerify[dw]){cz.dataNode._rowVerify[dw]=new Object();}cz.dataNode._rowVerify[dw]._width=j.value;this.updateItem();};var aY=$ce("span","&nbsp;",cN);var ag="字数";if(m._verify=="数字"||m._verify=="小数"){ag="值";}var aC=$ce("span","最小"+ag+"：",aY);var au=control_text("4");au.title="不填表示无限制";aY.appendChild(au);au.onchange=au.onblur=function(){var j=$$("select",c7)[0];var dw=j.value;var eh=parseInt(dw);if(!cz.dataNode._rowVerify[eh]){cz.dataNode._rowVerify[eh]=new Object();}var i=checkVerifyMinMax(au,d8,cz.dataNode._rowVerify[eh]._verify);if(i){show_status_tip(i,4000);this.value="";}cz.dataNode._rowVerify[eh]._minword=this.value;};var aj=$ce("span","最大"+ag+"：",aY);aj.style.marginLeft="10px";var d8=control_text("4");d8.title="不填表示无限制";d8.onchange=d8.onblur=function(){var j=$$("select",c7)[0];var dw=j.value;var eh=parseInt(dw);if(!cz.dataNode._rowVerify[eh]){cz.dataNode._rowVerify[eh]=new Object();}var i=checkVerifyMinMax(au,d8,cz.dataNode._rowVerify[eh]._verify);if(i){show_status_tip(i,4000);this.value="";}cz.dataNode._rowVerify[eh]._maxword=this.value;};aY.appendChild(d8);}}var cB=$ce("div","&nbsp;",aB);cB.style.clear="both";cB.style.lineHeight="1px";if(m._isShop){var cU=$ce("div","<div style='margin:10px 0 10px 18px;font-size:14px'><b style='color:#ff9900;'>商品支付方式:</b>&nbsp;&nbsp;<a href='/wjx/design/setactivitywpay.aspx?activity="+activityID+"' class='titlelnk' target='_blank'>设置微信支付</a></div>",aB);}var c0=document.createElement("div");c0.style.margin="10px 0px";var ba=control_btn("完成编辑");ba.className="submitbutton";ba.style.width="100%";ba.onclick=function(){qonclick.call(cz);};if(this.newAddQ){}c0.appendChild(ba);var o=$ce("span","",c0);o.style.color="red";o.style.fontSize="14px";o.style.display="inline-block";o.style.marginLeft="10px";aB.appendChild(c0);B.appendChild(aF);this.hasCreatedAttr=true;this.createEditBox=function(){if(this.hasEditBox){return;}this.hasEditBox=true;if(ab){ab.style.display="none";}G.style.height="102px";G.style.width="400px";var i=EditToolBarItemsPageCut;if(ec){i=EditToolBarItems;}KE.init({id:w,items:i,filterMode:filter,afterChange:function(j){KE.util.setData(j);},DesignPage:1});this.titleId=w;KE.create(w);KE.util.focus(w);};this.popHint=function(i){if(o){if(i){o.innerHTML="<b>提示：</b>"+i;}else{o.innerHTML="";}}};if(c){this.createEditBox();}this.checkTitle=function(){if(dV){var i=getGapFillCount(G.value);if(i==0){show_status_tip("填空题的标题必须包含空“"+GapFillStr+"”!",4000);this.isTitleValid=false;return false;}else{if(isMergeAnswer&&!cz.isMergeNewAdded){if(i<this.dataNode._gapcount){show_status_tip("合并答卷时，不能删除填空题标题中的空!",4000);this.isTitleValid=false;return false;}}}}var dw=G.value;if(!this.hasEditBox&&/\r\n|\n|\r/.test(dw)){dw=G.value=dw.replace(/\r\n|\n|\r/g,"<br />");d6.onclick();}if(dV){dw=replaceGapFill(dw,this.dataNode);}aa.innerHTML=dw;this.dataNode._title=G.value;this.isTitleValid=true;if(this.dataNode._type=="cut"){aa.innerHTML=dw||"请在此输入说明文字";if(this.div_video_title){this.div_video_title.innerHTML="";}if(this.dataNode._video){var j="<iframe height=498 width=510 src='"+this.dataNode._video+"' frameborder=0 allowfullscreen></iframe>";if(this.div_video_title){this.div_video_title.innerHTML=j;}else{this.div_video_title=$ce("div",j,aa);}}}if(!this.hasEditBox&&dw.indexOf("<")>-1){this.createEditBox();}return true;};this.checkDefault=function(){this.popHint("");var i=replace_specialChar(trim(bP.value));bP.value=i;if(au.value!=""&&i!=""&&i.length<au.value){this.popHint("您输入的默认值少于您设置的最小字数，请修改！");this.isDefaultValid=false;return false;}else{if(d8.value!=""&&i.length>d8.value){this.popHint("您输入的默认值超过了您设置的最大字数，请修改！");this.isDefaultValid=false;return false;}else{if(this.dataNode._verify!="省市区"&&this.dataNode._verify!="高校"){bY.value=i;}else{if(i){bY.value="指定省份为："+i;}else{bY.value="";}}this.dataNode._default=i;this.isDefaultValid=true;}}return true;};this.checkAnyJump=function(j){if(bT.checked){var eh;var i=toInt(this.dataNode._topic);eh=trim(bD.value);this.popHint("");if(eh!=1&&eh!=""&&eh!="0"){var dw="";if(!isPositive(eh)){dw="跳转题号必须为正整数";}else{if(toInt(eh)<=i){dw="跳转题号必须大于本题题号("+i+")";}else{if(toInt(eh)>total_question){dw="跳转题号必须小于或等于最大题号("+total_question+")";}}}if(dw){this.popHint(dw);this.isAnyJumpValid=false;return false;}else{this.dataNode._hasjump=true;}}else{if(eh==1){this.dataNode._hasjump=true;}else{this.dataNode._hasjump=false;}}cz.set_jump_ins();}if(this.isAnyJumpValid==true||this.isAnyJumpValid==undefined){if(bD._oldBorder||bD._oldBorder==""){bD.style.border=bD._oldBorder;bD.title=bD._oldTitle;}}if(!j){this.isAnyJumpValid=true;}else{this.isAnyJumpValid=false;}this.dataNode._anytimejumpto=trim(bD.value);return true;};this.setAnyTimeJumpTo=function(){bD.value=this.dataNode._anytimejumpto;};this.checkValid=function(){var ei=this.isAnyJumpValid==undefined||this.isAnyJumpValid;var ej=this.isTitleValid==undefined||this.isTitleValid;if(cG){var j=this.isDefaultValid==undefined||this.isDefaultValid;return ej&&j&&ei;}else{var em=this.isItemTitleValid==undefined||this.isItemTitleValid;var i=this.isItemJumpValid==undefined||this.isItemJumpValid;var dw=this.isItemValueValid==undefined||this.isItemValueValid;var eh=this.isRowTitleValid==undefined||this.isRowTitleValid;var ek=this.isColumnTitleValid==undefined||this.isColumnTitleValid;var el=this.isCeShiValid==undefined||this.isCeShiValid;return em&&i&&dw&&ei&&ej&&eh&&ek&&el;}};this.validate=function(){o.innerHTML="";this.checkTitle();if(cG){this.checkDefault();}else{if(u){this.checkRowTitle();}else{if(dT){if(ar){this.checkRowTitle();}if(bZ){this.checkColumnTitle();}this.checkItemTitle();this.checkItemValue();this.checkItemJump();if(this.checkCheckLimit){this.checkCheckLimit();}if(this.checkCeShiSet){this.checkCeShiSet();}}}}if(ec){this.checkAnyJump();}this.setErrorStyle();};this.setErrorStyle=function(){if(!this.checkValid()){this.className+=" div_question_error";}else{this.className=this.className.replace(/div_question_error/,"");}};this.setDataNodeToDesign=function(){var ej=this.dataNode;switch(ej._type){case"question":if(ej._verify=="多级下拉"){break;}G.value=ej._title;G.onblur();d8.value=ej._maxword;l.checked=ej._requir;bP.value=ej._default;if(ej._default){ej._olddefault=ej._default;A.click();}dY.value=ej._ins;if(ej._hasjump){bT.click();}bD.value=ej._anytimejumpto;ct.checked=ej._needOnly;bX.checked=ej._needsms;aT.value=ej._width;if(ej._underline){cm.checked=true;}au.value=ej._minword;this.initVerify();this.initWidth();this.initHeight();break;case"sum":G.value=ej._title;G.onblur();l.checked=ej._requir;ed.value=ej._rowtitle;cP.value=ej._total;dY.value=ej._ins;if(ej._hasjump){bT.click();}bD.value=ej._anytimejumpto;if(this._referDivQ){this.show_divAddFromCheck();bp.value=this._referDivQ.dataNode._topic;this.addFromCheck(bp);}break;case"cut":case"page":G.value=ej._title;G.onblur();if(ej._type=="page"){s.checked=ej._iszhenbie;bm.value=ej._mintime;dy.value=ej._maxtime;dy.onblur();}break;case"fileupload":G.value=ej._title;G.onblur();var en=$$("input",dS);var ep=ej._ext||defaultFileExt;J.value=ej._maxsize;var ei=ep.split("|");for(var eq=0;eq<en.length;eq++){en[eq].onclick=function(){if(!this.value){var ew=this.parentNode;var ev=$$("input",ew);for(var eu=0;eu<ev.length;eu++){if(ev[eu]!=this){ev[eu].checked=this.checked;}}}if(cur.updateExt){cur.updateExt(this);}};if(ei.indexOf(en[eq].value)>-1){en[eq].checked=true;}}for(var eq=0;eq<en.length;eq++){if(en[eq].value){continue;}var et=true;var em=en[eq].parentNode;var ek=$$("input",em);for(var j=0;j<ek.length;j++){if(ek[j]!=en[eq]&&!ek[j].checked){et=false;break;}}if(et){en[eq].checked=true;}}l.checked=ej._requir;dY.value=ej._ins;if(ej._hasjump){bT.click();}bD.value=ej._anytimejumpto;break;case"gapfill":G.value=ej._title;G.onblur();l.checked=ej._requir;dY.value=ej._ins;if(ej._hasjump){bT.click();}bD.value=ej._anytimejumpto;dl.checked=ej._useTextBox;break;case"slider":G.value=ej._title;G.onblur();l.checked=ej._requir;aG.value=ej._minvalue||0;d.value=ej._maxvalue||100;cc.value=ej._minvaluetext||"";aq.value=ej._maxvaluetext||"";dY.value=ej._ins;if(ej._hasjump){bT.click();}bD.value=ej._anytimejumpto;break;case"radio":case"radio_down":case"check":case"matrix":G.value=ej._title;G.onblur();dY.value=ej._ins;if(d9){d9.value=ej._numperrow;}b5.checked=ej._randomChoice;if(ej._hasvalue){P.checked=true;P.onclick();}if(ej._tag){P.disabled=true;}if(ej._type=="matrix"){this.initMainWidth();ed.value=ej._rowtitle;this.initWidth();if(ej._rowtitle2&&cA){cA.checked=true;cA.onclick();cA.checked=true;}if(ej._rowwidth2){this.initWidth2();}if(ej._daoZhi){if(cE){cE.checked=true;}}dX.style.display=(ej._tag>200&&ej._tag!="303")?"none":"";b3.style.display=dX.style.display;P.disabled=(ej._tag<=101||ej._tag==303)?true:false;}var el=false;var eh=!ej._tag&&(ej._type=="check"||ej._type=="radio"||ej._type=="radio_down");for(var dw=1;dw<ej._select.length;dw++){cY[dw].get_item_title().value=ej._select[dw]._item_title.replace(/&lt;/,"<");if(eh||ej._isCeShi){var i=ej._select[dw]._item_radio;cY[dw].get_item_check().checked=i;if(i){el=true;}if(ej._select[dw]._item_huchi){cY[dw].get_item_huchi().checked=true;}}if(el&&this.defaultCheckSet){this.defaultCheckSet();}var er=ej._select[dw]._item_value;if(ej._isShop&&(er=="0"||!er)){er="10";}cY[dw].get_item_value().value=er;if(er==NoValueData){cY[dw].get_item_value().value="";if(cY[dw].get_item_novalue()){cY[dw].get_item_novalue().checked=true;}}var es=ej._select[dw]._item_jump;cY[dw].get_item_jump().value=es;if(cY[dw].get_item_tb()){cY[dw].get_item_tb().checked=ej._select[dw]._item_tb;}if(cY[dw].get_item_tbr()){cY[dw].get_item_tbr().checked=ej._select[dw]._item_tbr;}if(cY[dw].get_item_img()){cY[dw].get_item_img().value=ej._select[dw]._item_img;}if(cY[dw].get_item_imgtext()){cY[dw].get_item_imgtext().checked=ej._select[dw]._item_imgtext;}if(cY[dw].get_item_desc()){cY[dw].get_item_desc().value=ej._select[dw]._item_desc;}if(cY[dw].get_item_label()){cY[dw].get_item_label().value=ej._select[dw]._item_label;}}l.checked=ej._requir;if(ej._hasjump){if(ej._type=="radio"||ej._type=="radio_down"){if(ej._anytimejumpto<1){cZ.click();}else{bT.click();}}else{bT.click();}}bD.value=ej._anytimejumpto;if(this._referDivQ){this.show_divAddFromCheck();bp.value=this._referDivQ.dataNode._topic;this.addFromCheck(bp);}break;}if(ej._ins){ej._oldins=ej._ins;aA.click();aA.checked=true;}try{G.focus();}catch(eo){}};}function setImage(b,a){PDF_close(b);}function creat_item(H,L,A,ag,F,I){var R=L;var W;var k=A.insertRow(R);var s=k.insertCell(-1);var a=control_text("15");a.tabIndex=1;a.title="回车添加新选项，上下键编辑前后选项";if(F){select_item_num++;}a.value=I?I._item_title:"选项"+select_item_num;if(A.rows.length-1==R&&cur&&(cur.dataNode._isQingJing||cur.dataNode._isShop)){var B="情景"+R;if(cur.dataNode._isShop){B="商品"+R;}var O=false;for(var Z=1;Z<cur.dataNode._select.length;Z++){if(cur.dataNode._select[Z]._item_title==B){O=true;break;}}if(!O){a.value=B;}}a.className+=" choicetxt";a.onchange=a.onblur=function(){if(!this.value){this.value=this.initText||"";}if(cur&&cur.updateItem){cur.updateItem();cur.checkTextJump(this.value);}};a.onfocus=function(){if(!this.initText){this.initText=this.value;}var j=/^选项\d+$/;if(j.test(this.value)){this.value="";}};a.onkeydown=function(ah){var j=ah||window.event;if(j.keyCode==13){X.onclick();}else{if(j.keyCode==40){if(R<cur.option_radio.length-1){cur.option_radio[R+1].get_item_title().focus();cur.option_radio[R+1].get_item_title().select();}}else{if(j.keyCode==38){if(R>1){cur.option_radio[R-1].get_item_title().focus();cur.option_radio[R-1].get_item_title().select();}}}}return true;};s.appendChild(a);s.style.width="150px";var u=cur||H;var i=u.dataNode._isCePing;if(u.dataNode._type=="matrix"&&u.dataNode._tag&&u.dataNode._tag<=101){s.style.width="100px";a.style.width="100px";}else{if(u.dataNode._type=="matrix"&&u.dataNode._tag=="303"){s.style.width="120px";a.style.width="120px";}}var Q=!u.dataNode._tag&&(u.dataNode._type=="check"||u.dataNode._type=="radio")&&!i;var b=u.dataNode._isCeShi;var o=u.dataNode._isQingJing;var v=u.dataNode._isShop;if((Q||i)&&!o){var y=k.insertCell(-1);if(v){y.align="center";}var ae=document.createElement("input");ae.type="hidden";ae.value=I?I._item_img:"";y.appendChild(ae);var P=document.createElement("span");P.title="添加图片";P.className="choiceimg design-icon design-img";y.appendChild(P);P.style.border=ae.value?"2px #ffff66 solid":"";if(ae.value){A.rows[0].cells[1].style.width="50px";}function p(ah){if(ah==undefined){return;}var j=cur.option_radio[R].get_item_img();j.value=ah;if(!v){cur.option_radio[R].get_item_imgtext().parentNode.style.display=(ah)?"":"none";}P.style.border=ah?"2px #ffff66 solid":"";A.rows[0].cells[1].style.width="47px";cur.updateItem();}P.onclick=function(){itemImage=cur.option_radio[R].get_item_img().value;PDF_launch("uploadimg.aspx?design=1",650,460,p,cur.option_radio[R].get_item_title().value);};var S=$ce("span","",y);var ad=control_check();S.style.verticalAlign="bottom";ad.title="是否显示选项文字";S.appendChild(ad);S.style.display=ae.value?"":"none";if(v){S.style.display="none";}ad.onclick=function(){cur.updateItem();};}if((Q||i)&&!v){var T=k.insertCell(-1);var E=document.createElement("span");E.title="选项说明，支持HTML，图片，视频等";E.className="choiceimg design-icon design-desc";T.appendChild(E);var g=document.createElement("input");g.type="hidden";g.value=I?(I._item_desc||""):"";T.appendChild(g);E.style.border=g.value?"2px #ffff66 solid":"";E.onclick=function(){openTitleEditor(g,function(ah){if(ah=="-1nc"||ah==undefined){return;}g.value=trim(ah);var j="";E.style.border=g.value?"2px #ffff66 solid":"";if(!o){j=cur.option_radio[R].get_item_img().value;cur.option_radio[R].get_item_imgtext().parentNode.style.display=(j)?"":"none";}cur.updateItem();if(j){setTimeout(function(){cur.updateItem();},20);}},cur.option_radio[R].get_item_title().value);};}if(Q||(u.dataNode._type=="matrix"&&(u.dataNode._tag=="102"||u.dataNode._tag=="103"||u.dataNode._tag=="101"))||i){var x=k.insertCell(-1);var U=$ce("span","",x);U.style.verticalAlign="bottom";var t=control_check();t.style.verticalAlign="bottom";t.title="允许填空";U.appendChild(t);t.checked=I?I._item_tb:false;var ac=$ce("span","&nbsp;",U);var m=control_check();m.title="文本框必填";ac.appendChild(document.createTextNode("必填"));ac.appendChild(m);m.checked=I?I._item_tbr:false;ac.style.visibility=t.checked?"visible":"hidden";t.onclick=function(){if(!this.checked){cur.option_radio[R].get_item_tbr().checked=false;}cur.option_radio[R].get_item_tbr().parentNode.style.visibility=this.checked?"visible":"hidden";cur.updateItem();};m.onclick=function(){cur.updateItem();};if(b||o||v){x.style.display="none";}}var z=k.insertCell(-1);z.align="left";var d=$ce("span","&nbsp;",z);var n=control_text("4");n.maxLength=5;n.title="在此可以设置每个选项的分数（请输入整数）";if(o){n.title="请设置每个情景需要的数量,0表示不限制";}else{if(v){n.title="设置商品价格";}}n.value=I?I._item_value:R;d.appendChild(n);if(u.dataNode._hasvalue&&(i||u.dataNode._tag)){z.style.display="";if(u.dataNode._type!="check"&&u.dataNode._tag!="303"){var af=control_check();af.title="不记分";af.onclick=function(){n.value="";cur.updateItem();};n.style.width="25px";z.appendChild(af);$ce("span","不记分",z);}}else{if(!o&&!v){z.style.display="none";}}n.onchange=n.onblur=function(){if(i||(cur.dataNode._type=="radio"&&cur.dataNode._tag)){cur.updateItem();}else{cur.updateItem(true);}};n.onkeydown=function(ah){var j=ah||window.event;if(j.keyCode==13){X.onclick();}else{if(j.keyCode==40){if(R<cur.option_radio.length-1){cur.option_radio[R+1].get_item_value().select();}}else{if(j.keyCode==38){if(R>1){cur.option_radio[R-1].get_item_value().select();}}}}};var l=k.insertCell(-1);if(H.dataNode._type=="matrix"){l.style.display="none";}var K=$ce("span","&nbsp;&nbsp;",l);l.align="left";var G=control_text(3);G.maxLength=4;if(v){G.title="为空表示不限制库存，0表示已售完";}G.value=I?I._item_jump:"";if(u.dataNode._hasjump&&u.dataNode._anytimejumpto=="0"){K.style.display="";}else{if(v){K.style.display="";}else{K.style.display="none";}}K.appendChild(G);G.onclick=function(){if(!v){openJumpWindow(u,this);}};G.onmouseout=function(){if(!v){sb_setmenunav(toolTipLayer,false);}};G.onmouseover=function(){if(!v){if(!this.error){if(!this.title||this.hasChanged){this.title=getJumpTitle(this.value);}}}};G.onblur=function(){if(v&&!vipUser){alert("提示：库存功能仅对企业版开放！");this.value="";return;}if(this.value==this.prevValue){this.hasChanged=false;return;}this.hasChanged=true;this.prevValue=this.value;cur.updateItem(true);};G.onkeydown=function(ah){var j=ah||window.event;if(j.keyCode==13){X.onclick();}else{if(j.keyCode==40){if(R<cur.option_radio.length-1){cur.option_radio[R+1].get_item_jump().select();}}else{if(j.keyCode==38){if(R>1){cur.option_radio[R-1].get_item_jump().select();}}}}};var C=null;if(Q&&ag=="check"&&!b&&!v){var N=k.insertCell(-1);var w=$ce("span","&nbsp;",N);N.align="left";C=control_check();C.title="与其它选项互斥";w.appendChild(C);C.onclick=function(){cur.updateItem();};}var f=k.insertCell(-1);var M=$ce("span","&nbsp;",f);f.align="left";var aa=null;aa=control_check();if(!b){aa.title="若选中，用户在填问卷时此选项会默认被选中";}if((Q||u.dataNode._type=="radio_down")&&!o&&!v){f.style.display="";}else{f.style.display="none";}M.appendChild(aa);if((Q||u.dataNode._type=="radio_down")&&ag=="radio"){aa.onclick=function(){if(this.checked){for(var j=1;j<cur.option_radio.length;j++){if(cur.option_radio[j].get_item_check()==this){this.checked=true;}else{cur.option_radio[j].get_item_check().checked=false;}}}cur.updateItem();};}if(Q&&ag=="check"){aa.onclick=function(){cur.updateItem();};}if(Q){var h=k.insertCell(-1);h.align="left";h.style.width="80px";var Y=$ce("a","分组",h);Y.tabIndex="-1";Y.className="link-666";if(cur&&cur.dataNode._select[R]&&cur.dataNode._select[R]._item_label){Y.innerHTML="编辑";}Y.href="javascript:void(0);";var r=document.createElement("input");r.type="hidden";r.value=I?(I._item_label||""):"";h.appendChild(r);Y.onclick=function(){if(!vipUser){alert("只有企业版用户才能插入分组，请升级！");return;}openTitleEditor(r,function(j){if(j=="-1nc"||j==undefined){return;}r.value=trim(j);Y.innerHTML=r.value?"编辑":"分组";cur.updateItem();});};if(b||o||v){h.style.display="none";}}var J=k.insertCell(-1);var X=document.createElement("span");X.title="在此选项下面插入一个新的选项";X.className="choiceimg design-icon design-add";var e=document.createElement("span");e.title="删除当前选项（最少保留2个选项）";e.className="choiceimg design-icon design-minus";var V=document.createElement("span");V.title="将当前选项上移一个位置";V.className="choiceimg design-icon design-up";var D=document.createElement("span");D.title="将当前选项下移一个位置";D.className="choiceimg design-icon design-down";J.appendChild(X);J.appendChild(e);J.appendChild(V);J.appendChild(D);X.style.cursor="pointer";e.style.cursor="pointer";V.style.cursor="pointer";D.style.cursor="pointer";X.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded&&R<cur.option_radio.length-1){alert("合并答卷模式下编辑问卷原始题目不能在中间插入选项！");return;}if(isMergeAnswer&&!cur.isMergeNewAdded&&!confirm("此题不能删除选项，是否确认增加选项？")){return;}for(var j=cur.option_radio.length-1;j>R;j--){cur.option_radio[j].set_item_num(j+1);cur.option_radio[j+1]=cur.option_radio[j];}if(ag=="radio"){cur.option_radio[R+1]=new creat_item(cur,R+1,A,"radio",true);}if(ag=="check"){cur.option_radio[R+1]=new creat_item(cur,R+1,A,"check",true);}cur.updateItem();cur.option_radio[R+1].get_item_title().select();};e.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded){alert("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许删除原始题目的选项！");return;}if(cur.option_radio.length>3){A.deleteRow(R);for(var ah=R+1;ah<cur.option_radio.length;ah++){cur.option_radio[ah].set_item_num(ah-1);cur.option_radio[ah-1]=cur.option_radio[ah];}cur.option_radio.length--;cur.updateItem();}else{show_status_tip("选择题至少要有两个选项",4000);}};V.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded){alert("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许移动原始题目的选项！");return;}if((R-1)>0){c(cur.option_radio[R],cur.option_radio[R-1]);if(ag=="check"||ag=="radio"){ab(cur.option_radio[R],cur.option_radio[R-1]);}q(cur.option_radio[R],cur.option_radio[R-1]);cur.updateItem();}};D.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded){alert("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许移动原始题目的选项！");return;}if((R+1)<cur.option_radio.length){c(cur.option_radio[R],cur.option_radio[R+1]);if(ag=="check"||ag=="radio"){ab(cur.option_radio[R],cur.option_radio[R+1]);}q(cur.option_radio[R],cur.option_radio[R+1]);cur.updateItem();}};function c(ai,j){var ah=ai.get_item_title().value;ai.get_item_title().value=j.get_item_title().value;j.get_item_title().value=ah;}function ab(ai,j){var ah=ai.get_item_check().checked;ai.get_item_check().checked=j.get_item_check().checked;j.get_item_check().checked=ah;}function q(ai,j){var ah=ai.get_item_value().value;ai.get_item_value().value=j.get_item_value().value;j.get_item_value().value=ah;ah=ai.get_item_jump().value;ai.get_item_jump().value=j.get_item_jump().value;j.get_item_jump().value=ah;if(ai.get_item_novalue()){ah=ai.get_item_novalue().checked;ai.get_item_novalue().checked=j.get_item_novalue().checked;j.get_item_novalue().checked=ah;}if(ai.get_item_tb()){ah=ai.get_item_tb().checked;ai.get_item_tb().checked=j.get_item_tb().checked;j.get_item_tb().checked=ah;}if(ai.get_item_tbr()){ah=ai.get_item_tbr().checked;ai.get_item_tbr().checked=j.get_item_tbr().checked;j.get_item_tbr().checked=ah;}if(ai.get_item_img()){ah=ai.get_item_img().value;ai.get_item_img().value=j.get_item_img().value;j.get_item_img().value=ah;}if(ai.get_item_imgtext()){ah=ai.get_item_imgtext().checked;ai.get_item_imgtext().checked=j.get_item_imgtext().checked;j.get_item_imgtext().checked=ah;}if(ai.get_item_desc()){ah=ai.get_item_desc().value;ai.get_item_desc().value=j.get_item_desc().value;j.get_item_desc().value=ah;}if(ai.get_item_label()){ah=ai.get_item_label().value;ai.get_item_label().value=j.get_item_label().value;j.get_item_label().value=ah;}}this.get_item_add=function(){return X;};this.get_item_del=function(){return e;};this.get_item_table=function(){return W;};this.get_item_tr=function(){return k;};this.set_item_num=function(j){R=j;};this.get_item_num=function(){return R;};this.get_item_title=function(){return a;};this.get_item_check=function(){return aa;};this.get_item_huchi=function(){return C;};this.get_item_tb=function(){return t;};this.get_item_tbr=function(){return m;};this.get_item_img=function(){return ae;};this.get_item_desc=function(){return g;};this.get_item_label=function(){return r;};this.get_item_imgtext=function(){return ad;};this.get_item_value=function(){return n;};this.get_item_novalue=function(){return af;};this.get_item_jump=function(){return G;};return true;}function setAllRequired(c){for(var a=0;a<questionHolder.length;a++){var b=questionHolder[a].dataNode._type;if(b!="cut"&&b!="page"&&questionHolder[a].dataNode._requir!=c){if(questionHolder[a].get_requir){questionHolder[a].get_requir().checked=c;}questionHolder[a].dataNode._requir=c;questionHolder[a].setreqstatus();}}show_status_tip("设置成功！",4000);}function setAllRandom(){var a=cur.dataNode._randomChoice;for(var b=0;b<questionHolder.length;b++){if(!questionHolder[b].dataNode._isCeShi){continue;}if(questionHolder[b].dataNode._type=="question"){continue;}if(questionHolder[b].get_random){questionHolder[b].get_random().checked=a;}questionHolder[b].dataNode._randomChoice=a;}show_status_tip("设置成功！",4000);}initAttrHandler();function initAttrHandler(){firstPage.createAttr=createAttr;for(var b=0;b<questionHolder.length;b++){var a=questionHolder[b];setAttrHander(a);}}function setAttrHander(a){a.createAttr=createAttr;}